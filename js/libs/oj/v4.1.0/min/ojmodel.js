/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise"],function(a,g){a.xa=a.Events={on:function(a,b,d){return this.dt(a,b,d,!1,!1)},off:function(a,b,d){return this.y5(a,b,d,!1)},trigger:function(c){var b=Array.prototype.slice.call(arguments);b.unshift(!1);return a.xa.vd.apply(this,b)},once:function(a,b,d){return this.upa(a,b,d,!1,null)},listenTo:function(c,b,d){var e,f,h,k,l={};b.constructor===String?l[b]=d:l=b;for(k in l)if(l.hasOwnProperty(k))for(b=a.xa.$z(k),d=0;d<b.length;d+=1)e=b[d].event,f=b[d].Aa,h={event:e,
Aa:f,object:c,Hc:l[k]},this.J0(this._listeningTo,h,a.xa.Eoa),e=f?e+":"+f:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),c.dt(e,l[k],null,!0,!1);return this},listenToOnce:function(c,b,d){var e,f,h,k,l={};b.constructor===String?l[b]=d:l=b;for(k in l)if(l.hasOwnProperty(k))for(b=a.xa.$z(k),d=0;d<b.length;d+=1)e=b[d].event,f=b[d].Aa,h={event:e,Aa:f,object:c,Hc:l[k]},this.J0(this._listeningTo,h,a.xa.Eoa),e=f?e+":"+f:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),
c.upa(e,l[k],null,!0,this);return this},stopListening:function(c,b,d){var e,f={},h,k,l,g,p,t,s,n,q;if(null==arguments||1>=arguments.length){t=this._listeningTo?this._listeningTo.length:0;for(n=0;n<t;n++)if(g=this._listeningTo[n],p=c?c===g.object:!0)p=g.object.y5,p.apply(g.object,[g.event,g.Hc,g.context,!0]);this._listeningTo=[];return this}e=b;c&&c.constructor===String&&(e=c);e.constructor===String?f[e]=d:f=e;for(q in f)if(f.hasOwnProperty(q))for(e=a.xa.$z(q),h=0;h<e.length;h+=1)for(k=e[h].event,
l=e[h].Aa,t=this._listeningTo?this._listeningTo.length:0,n=t-1;0<=n;n-=1)g=this._listeningTo[n],p=c?c===g.object:!0,t=k?k===g.event:!0,s=d?f[q]===g.Hc:!0,g=l?l===g.Aa:!0,p&&t&&s&&g&&(p=this._listeningTo[n].object.y5,p.apply(this._listeningTo[n].object,[this._listeningTo[n].event,this._listeningTo[n].Hc,this._listeningTo[n].context,!0]),this._listeningTo.splice(n,1));return this}};a.xa.bind=a.xa.on;a.xa.unbind=a.xa.off;a.xa.ga={ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",
SORT:"sort",CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"};o_("Events.EventType",a.xa.ga,a);a.xa.DY=function(a,b){var d,e=b||this;for(d in e)"function"===typeof e[d]&&(a[d]=e[d]);a.Xf={};a._listeningTo=[]};a.xa.upa=function(a,b,d,e,f){var h,k,l,g;l=this.F2(a,b);for(g in l)if(l.hasOwnProperty(g))for(a=this.$z(g),b=0;b<a.length;b+=1)h=a[b].event,k=a[b].Aa,void 0===this.Xf&&(this.Xf=[]),void 0===this.Xf[h]&&
(this.Xf[h]=[]),this.Xf[h].push({Hc:l[g],context:d,Aa:k,lv:!0,fired:!1,Vx:e,AN:f});return this};a.xa.ssa=function(a){return a.lv?a.fired?!1:a.fired=!0:!0};a.xa.rka=function(a,b){return b.context||b.AN||a};a.xa.vd=function(c,b){var d=this.$z(b),e,f,h,k,l,g;k=[];for(e=0;e<d.length;e+=1)f=d[e].event,h=d[e].Aa,k.push({event:f,Aa:h});for(e=0;e<k.length;e+=1){l=this.zR(this.Xf,a.xa.ga.ALL);d=a.xa.zR(this.Xf,k[e].event,!1);for(f=0;f<(d?d.length:0);f+=1)d[f].Aa===k[e].Aa&&d[f].Hc&&(h=Array.prototype.slice.call(arguments),
d&&d[f]&&d[f].lv&&(this.xqa(a.xa.zR(this.Xf,k[e].event,!0),d[f]),d[f].AN&&d[f].AN.stopListening(this,b,d[f].Hc)),d&&d[f]&&this.ssa(d[f])&&(g=d[f].Hc,c&&!d[f].fxa||g.apply(a.xa.rka(this,d[f]),h.slice(2))));for(f=0;f<(l?l.length:0);f+=1)h=Array.prototype.slice.call(arguments),0<h.length&&(h[1]=k[e].Aa?k[e].event+":"+k[e].Aa:k[e].event),l&&l[f]&&l[f].Hc&&this.ssa(l[f])&&(g=l[f].Hc,c&&!l[f].fxa||g.apply(a.xa.rka(this,l[f]),h.slice(1))),l&&l[f]&&l[f].lv&&(this.xqa(this.zR(this.Xf,a.xa.ga.ALL,!0),l[f]),
l[f].AN&&l[f].AN.stopListening(this,a.xa.ga.ALL,l[f].Hc))}return this};a.xa.dt=function(c,b,d,e,f){var h,k,g,m;c=this.F2(c,b);for(h in c)if(c.hasOwnProperty(h))for(b=this.$z(h),k=0;k<b.length;k+=1)g=b[k].event,m=b[k].Aa,void 0===this.Xf&&(this.Xf=[]),void 0===this.Xf[g]&&(this.Xf[g]=[]),m={Hc:c[h],context:d,Aa:m,Vx:e,fxa:f},-1===this.J0(this.Xf[g],m,a.xa.WQa)&&this.Xf[g].push(m);return this};a.xa.y5=function(a,b,d,e){var f,h;if(null==arguments||0==arguments.length)return this.Xf={},this;if(null==
a)return this.wqa(a,b,d,e),this;f=this.F2(a,b);for(h in f)f.hasOwnProperty(h)&&this.wqa(h,f[h],d,e);return this};a.xa.F2=function(a,b){var d={};a.constructor===String?d[a]=b:d=a;return d};a.xa.wqa=function(c,b,d,e){var f=[],h,k,g,m,p,t,s,n;if(c)f=a.xa.$z(c);else if(void 0!==this.Xf)for(k in this.Xf)this.Xf.hasOwnProperty(k)&&f.push({event:k});for(c=0;c<f.length;c+=1)if(k=f[c].event,g=f[c].Aa,void 0!==this.Xf&&this.Xf[k]instanceof Array){m=this.Xf[k];for(h=m.length-1;0<=h;h-=1)p=void 0===b||null===
b||m[h].Hc==b,t=void 0===d||null===d||m[h].context==d,s=void 0===g||null===g||m[h].Aa==g,n=void 0===e||null===e||m[h].Vx==e,p&&t&&s&&n&&m.splice(h,1);0===m.length&&delete this.Xf[k]}};a.xa.xqa=function(a,b){var d,e,f,h,k,g;if(a)for(d=a.length-1;0<=d;d-=1)e=void 0===b.Hc||null===b.Hc||a[d].Hc==b.Hc,f=void 0===b.context||null===b.context||a[d].context==b.context,h=void 0===b.Aa||null===b.Aa||a[d].Aa==b.Aa,k=void 0===b.Vx||null===b.Vx||a[d].Vx==b.Vx,g=void 0===b.lv||null===b.lv||a[d].lv==b.lv,e&&f&&
h&&k&&g&&a.splice(d,1)};a.xa.$z=function(a){a=a?a.split(" "):[];var b=[],d,e,f;for(d=0;d<a.length;d+=1)e=a[d].split(":"),f=e[0],e=1<e.length?e[1]:null,b.push({event:f,Aa:e});return b};a.xa.WQa=function(a,b){return a.Hc===b.Hc&&a.Aa===b.Aa&&a.context===b.context&&a.Vx===b.Vx&&a.lv===b.lv};a.xa.Eoa=function(a,b){return a.event===b.event&&a.Aa===b.Aa&&a.context===b.context&&a.object===b.object};a.xa.J0=function(a,b,d){var e;if(void 0===a)return-1;for(e=0;e<a.length;e+=1)if(d(a[e],b))return e;return-1};
a.xa.zR=function(a,b,d){if(a&&a[b]instanceof Array){if(d)return a[b];d=[];var e;for(e=0;e<a[b].length;e++)d.push(a[b][e]);return d}return null};a.U=function(c,b){a.U._init(this,c,b,null)};o_("Model",a.U,a);a.f.va(a.U,a.f,"oj.Model");a.U.prototype.Init=function(){a.U.N.Init.call(this)};a.U.prototype.attributes={};a.f.j("Model.prototype.attributes",{attributes:a.U.prototype.attributes});a.U.prototype.Md={};a.f.j("Model.prototype.defaults",{Md:a.U.prototype.Md});a.U.prototype.id=null;a.f.j("Model.prototype.id",
{id:a.U.prototype.id});a.U.prototype.exa="id";a.f.j("Model.prototype.idAttribute",{exa:a.U.prototype.exa});a.U.prototype.kAa=null;a.f.j("Model.prototype.urlRoot",{kAa:a.U.prototype.kAa});a.U.prototype.fq=null;a.f.j("Model.prototype.customURL",{fq:a.U.prototype.fq});a.U.prototype.validate=null;a.f.j("Model.prototype.validate",{validate:a.U.prototype.validate});a.U.prototype.lAa=null;a.f.j("Model.prototype.validationError",{lAa:a.U.prototype.lAa});a.U.x4=0;a.U._init=function(c,b,d,e){var f=null,h;if(!a.U.xK){c.Init();
a.xa.DY(c);c.tD();c.eaa={};c.ZW=!1;c.index=-1;d=d||{};c.attributes={};c.defaults&&!d.n3a&&(c.attributes=a.U.wQ(g.isFunction(c.defaults)?c.defaults():c.defaults,null));for(f in e)e.hasOwnProperty(f)&&(c[f]=e[f]);if(b)if(e=d.parse,g.isFunction(e)&&(c.parse=e),c.attributes=h=a.U.wQ(b,c.attributes),h=e?c.parse(h):h,null==h||void 0===h)c.attributes={};else for(f in h)h.hasOwnProperty(f)&&c.V6(f,h[f],!1,!1,d,!0);c.LO();c.sH(d.collection);d.customURL&&(c.customURL=d.customURL);d.url&&(c.url=d.url);d.urlRoot&&
(c.urlRoot=d.urlRoot);c.initialize&&c.initialize(b,d);c.Sq()}};a.U.extend=function(c,b){a.U.xK=!0;var d,e;d=new a.U;a.U.xK=!1;g.extend(d,this.prototype);c=c||{};for(e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);var f;f=c&&c.constructor&&c.hasOwnProperty("constructor")?c.constructor:function(b,d){a.U._init(this,b,d,c)};g.extend(f,this);f.prototype=d;f.extend=a.U.extend;f.prototype.constructor=f;a.xa.DY(f,this);if(b)for(e in b)b.hasOwnProperty(e)&&(f[e]=b[e]);return f};o_("Model.extend",a.U.extend,a);a.U.prototype.vd=
function(){};a.U.prototype.LO=function(){this.Qy()||(this.cid="id"+a.U.x4,a.U.x4+=1)};a.U.prototype.Qy=function(){return this.cid};a.U.prototype.tH=function(a){this.index=a};a.U.prototype.Nba=function(){return this.index};a.U.prototype.RY=function(a){this.o4a=a};a.U.prototype.MO=function(a){var b=this.faa;this.faa=a;return b};a.U.prototype.rBa=function(c,b,d){var e,f=!1,h=a.Wa.Hd(b),k,g=!1;for(e in c.attributes)c.attributes.hasOwnProperty(e)&&(k=this.attributes[e]!=c.attributes[e],h?e===b&&k&&(f=
!0):k&&(f=!0),k&&(g=!0,this.attributes[e]=c.attributes[e],this.O_(e,c.attributes[e]),this.fR(e,this.attributes[e],null,d)));this.Sq();g&&this.gR(null,d);return f};a.U.pS=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;return!1};a.U.prototype.sH=function(a){null==a?delete this.collection:(this.collection=a,this.Sq())};a.U.prototype.aH=function(){return this.collection};a.U.prototype.fR=function(c,b,d,e){null!=c&&this.vd(e,a.xa.ga.CHANGE+":"+c,this,b,d)};a.U.prototype.gR=
function(c,b){this.vd(b,a.xa.ga.CHANGE,this,c,null)};a.U.prototype.Sq=function(){var a=null;this.collection&&this.collection.modelId&&(a=this.collection.modelId,a=g.isFunction(a)?a.call(this.collection,this.attributes):a);a||(a=this.L2(),a=null!=this.attributes?this.attributes[a]:null);this.id=a};a.U.prototype.YXa=function(c,b,d){var e=a.f.mI(this.attributes[c],b);return d||!e?(this.attributes[c]=b,this.Sq(),!e):!1};a.U.prototype.tD=function(){this.changed={}};a.U.prototype.O_=function(a,b){this.changed[a]=
b};a.U.prototype.V6=function(c,b,d,e,f,h){if(null==c)return!0;var k={},g,m=this.ZW;if(e)for(g in c)c.hasOwnProperty(g)&&(k[g]=c[g]);else k[c]=b;c=f||{};if(!this.JI(k,{validate:c.validate},!1))return!1;m||(this.tD(),this.Gx=[]);this.ZW||h||(this.eaa=a.U.wQ(this.attributes,null));this.ZW=!0;for(g in k)k.hasOwnProperty(g)&&(this.YXa(g,k[g],d)?(this.O_(g,k[g]),this.Gx.push(g)):delete k[g]);d=c.silent;for(g in k)k.hasOwnProperty(g)&&(!d&&(0<this.Gx.length||m&&-1===this.Gx.indexOf(g))&&(this.Mya=!0,this.B4a=
c),this.fR(g,k[g],c,d));if(m)return!0;if(!d&&!m)for(;this.Mya;)this.Mya=!1,this.gR(this.B4a,d);this.ZW=!1;return!0};a.U.prototype.clear=function(c){var b,d={silent:!0},e;c=c||{};e=c.silent;d.validate=c.validate;this.tD();for(b in this.attributes)if(this.attributes.hasOwnProperty(b)){if(!this.FU(b,d,!0))return!1;this.vd(e,a.xa.ga.CHANGE+":"+b,this,void 0,null)}this.attributes={};this.Sq();this.fR(null,null,null,e);this.gR(null,e);return this};a.f.j("Model.prototype.clear",{clear:a.U.prototype.clear});
a.U.wQ=function(c,b){b=b||{};var d,e=!0;if(0<Object.keys(b).length){for(d in b)b.hasOwnProperty(d)&&c.hasOwnProperty(d)&&void 0===c[d]&&delete c[d];a.oc.Ed(b,c,void 0,!0,1E4);return b}var f;for(d in c)if(f=g.type(c[d]),"function"===f||"undefined"===f||"date"===f||"array"===f||"object"===f){e=!1;break}e?b=JSON.parse(JSON.stringify(c)):a.oc.Ed(b,c,void 0,!0,1E4);return b};a.U.prototype.clone=function(){var c=new this.constructor,b;for(b in this)this.hasOwnProperty(b)&&this[b]!==this.attributes&&(c[b]=
this[b]);c.attributes=a.U.wQ(this.attributes,null);delete c.cid;c.LO();c.Sq();return c};a.f.j("Model.prototype.clone",{clone:a.U.prototype.clone});a.U.prototype.Yy=function(a,b){var d=this.Gk();if(void 0!==d&&d==a)return!0;d=this.cid;return void 0!==d&&d==b?!0:!1};a.U.prototype.set=function(c,b,d){var e=d||{},f,h=!0;if(arguments&&0<arguments.length)if(a.Wa.Hd(c))e.unset?this.FU(c,null,!1):this.V6(c,b,!1,!1,e,!1)||(h=!1);else if(e=b||{},e.unset)for(f in c)c.hasOwnProperty(f)&&this.FU(f,null,!1);else this.V6(c,
null,!0,!0,e,!1)||(h=!1);return h?this:!1};a.f.j("Model.prototype.set",{set:a.U.prototype.set});a.U.prototype.iAa=function(a,b){return this.FU(a,b,!1)};a.f.j("Model.prototype.unset",{iAa:a.U.prototype.iAa});a.U.prototype.FU=function(a,b,d){b=b||{};var e=b.silent,f={};if(this.has(a)){if(!this.JI(f,b,!1))return!1;d||this.tD();delete this.attributes[a];this.O_(a,void 0);this.fR(a,null,null,e);this.gR(null,e)}this.Sq();return!0};a.U.prototype.get=function(a){return this.attributes[a]};a.f.j("Model.prototype.get",
{get:a.U.prototype.get});a.U.prototype.has=function(c){return a.t.St(this.attributes[c])};a.f.j("Model.prototype.has",{has:a.U.prototype.has});a.U.prototype.fetch=function(c){c=c||{};var b=c.success,d=c.error,e=this,f;f=a.U.AQ(c);f.error=function(b,f,g){a.U.SL(e,!1,c,f,g,b);d&&d.apply(e,arguments)};f.success=function(d){f.xhr&&(c.xhr=f.xhr);a.U.hR(e,d,f);g.isFunction(e.parse)&&e.set(e.parse(d),f);b&&b.call(a.U.Qn(f,e),e,d,c)};return a.U.hK("read",this,f)};a.f.j("Model.prototype.fetch",{fetch:a.U.prototype.fetch});
a.U.prototype.parse=function(a){return a};a.U.prototype.url=function(){var c=this.jma(),b=this.Gk();if(c)return b?c+"/"+encodeURIComponent(b):c;if(c=this.collection)return c=a.U.Dv(c,"url"),b&&c?(b="/"==a.U.wNa(c)?"":"/",c+b+encodeURIComponent(this.Gk())):c;throw new a.Ov;};a.f.j("Model.prototype.url",{url:a.U.prototype.url});a.U.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(a);return b};a.f.j("Model.prototype.keys",{keys:a.U.prototype.keys});
a.U.prototype.values=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};a.f.j("Model.prototype.values",{values:a.U.prototype.values});a.U.prototype.Lya=function(){var a,b=[],d;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(d=[],d.push(a),d.push(this.get(a)),b.push(d));return b};a.f.j("Model.prototype.pairs",{Lya:a.U.prototype.Lya});a.U.prototype.Gya=function(a){var b=[],d,e,f={};if(a instanceof Array)b=a;else for(d=0;d<arguments.length;d++)b.push(arguments[d]);
for(e in this.attributes)this.attributes.hasOwnProperty(e)&&-1==b.indexOf(e)&&(f[e]=this.get(e));return f};a.f.j("Model.prototype.omit",{Gya:a.U.prototype.Gya});a.U.prototype.Nya=function(a){var b=[],d,e={};if(a instanceof Array)b=a;else for(d=0;d<arguments.length;d++)b.push(arguments[d]);for(d=0;d<b.length;d++)this.attributes.hasOwnProperty(b[d])&&(e[b[d]]=this.get(b[d]));return e};a.f.j("Model.prototype.pick",{Nya:a.U.prototype.Nya});a.U.prototype.mxa=function(){var a,b={},d;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
(d=this.get(a),b[d]=a);return b};a.f.j("Model.prototype.invert",{mxa:a.U.prototype.mxa});a.U.wNa=function(a){return a.charAt(a.length-1)};a.U.prototype.$Wa=function(){var a=this.jma();return a?a:this.aH()?this.aH().url:null};a.U.prototype.jma=function(){return a.U.Dv(this,"urlRoot")};a.U.prototype.parseSave=function(a){return a};a.U.prototype.isValid=function(){var a={};a.validate=this.validate;return this.JI(this.attributes,a,!1)};a.f.j("Model.prototype.isValid",{isValid:a.U.prototype.isValid});
a.U.NSa=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};a.U.prototype.JI=function(c,b,d){b=b||{};var e=this.validate;return e&&a.U.NSa(b,d)&&(this.validationError=e.call(this,c,b))?(this.vd(!1,a.xa.ga.INVALID,this,this.validationError,b),!1):!0};a.U.MUa=function(c){var b=!1,d={},e,f={};if(c&&0<c.length){1<c.length&&c[c.length-1]&&a.U.pS(c[c.length-1])&&(b=!0,d=c[c.length-1]||{});if(null==c[0])return{attributes:null,options:d};if(a.U.pS(c[0])||a.f.Bi(c[0]))for(e in c[0])c[0].hasOwnProperty(e)&&
(f[e]=c[0][e]);else for(e=0;e<c.length;e+=2)if(void 0!==c[e]||e<c.length-1||!b&&e===c.length-1)f[c[e]]=c[e+1]}return{attributes:f,options:d}};a.U.AQ=function(a){var b={},d;a=a||{};for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b};a.U.SL=function(c,b,d,e,f,h){d=d||{};d.textStatus=e;d.errorThrown=f;c.vd(b,a.xa.ga.ERROR,c,h,d)};a.U.prototype.save=function(c,b){var d,e,f,h,k,l;d=a.U.MUa(arguments);var m,p,t;t=void 0===c?void 0:d.attributes;b=b||{};m=a.U.AQ(d.options);d=g.extend(!0,{},this.attributes,
t);if(!this.JI(d,m,!0))return!1;m.wait||this.set(t);d=void 0===m.forceNew?!1:m.forceNew;h=this;k=m.error;l=m.patch;m.error=function(c,d,e){a.U.SL(h,!1,b,d,e,c);k&&k.apply(h,arguments)};m.saveAttrs=m.wait?this.NHa(t):this.attributes;p=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=p;if(!d&&!this.UM())return e=m.success,m.success=function(c){var d;m.xhr&&(b.xhr=m.xhr);if(c&&!a.f.Bi(c)){d=g.isFunction(h.parse)?h.parse(c):c;h.attributes=g.extend(!0,h.attributes,
d);if(m.wait)for(var f in t)d.hasOwnProperty(f)&&(t[f]=d[f]);h.Sq()}a.U.hR(h,c,m);m.wait&&h.set(t);e&&e.call(a.U.Qn(m,h),h,c,b);h.tD()},m.attrs||(m.attrs=void 0===t?void 0:l?t:m.saveAttrs),a.U.hK(l?"patch":"update",this,m);f=a.U.Tla(m);m.success=function(c){var d;m.xhr&&(b.xhr=m.xhr);if(c&&!a.f.Bi(c)){d=g.isFunction(h.parse)?h.parse(c):c;if(!h.JI(d,m,!0))return;h.attributes=g.extend(!0,h.attributes,d);if(m.wait)for(var e in t)d.hasOwnProperty(e)&&(t[e]=d[e]);h.Sq()}a.U.hR(h,c,m);m.wait&&h.set(t);
f&&f.call(a.U.Qn(m,h),h,c,b);h.tD()};m.attrs||(m.attrs=m.saveAttrs);m.parse=!0;l&&(m.saveAttrs=m.attrs);return a.U.hK("create",this,m)};a.f.j("Model.prototype.save",{save:a.U.prototype.save});a.U.prototype.NHa=function(a){var b={},d;for(d in this.attributes)this.attributes.hasOwnProperty(d)&&(b[d]=this.attributes[d]);for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b};a.U.Dv=function(a,b){return a?g.isFunction(a[b])?a[b]():a[b]:g.isFunction(b)?b():b};a.U.Yba=function(a){return a&&a.hasOwnProperty("value")&&
a.hasOwnProperty("comparator")};a.U.prototype.YQa=function(c){for(var b in c)if(c.hasOwnProperty(b)){if(!this.attributes.hasOwnProperty(b))return!1;for(var d=Array.isArray(c[b])?c[b]:[c[b]],e=0;e<d.length;e++)if(a.U.Yba(d[e])){var f=d[e].comparator,h=d[e].value;if(a.Wa.Hd(f))throw Error("String comparator invalid for local where/findWhere");if(!f(this,b,h))return!1}else if(c[b]!==this.attributes[b])return!1}return!0};a.U.prototype.matches=function(a){a:{for(var b in a)if(this.get(b)!==a[b]){a=!1;
break a}a=!0}return a};a.f.j("Model.prototype.matches",{matches:a.U.prototype.matches});a.U.prototype.HAa=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.YQa(a[b]))return!0;return!1};a.U.Tla=function(a){return null!=a&&a.success?a.success:null};a.U.Qn=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};a.U.prototype.UM=function(){return void 0==this.Gk()};a.f.j("Model.prototype.isNew",{UM:a.U.prototype.UM});a.U.prototype.L2=function(){return this.idAttribute||
"id"};a.U.prototype.Gk=function(){return this.id};a.U.prototype.B8=function(c){if(c){var b={},d;for(d in c)c.hasOwnProperty(d)&&(a.f.mI(c[d],this.attributes[d])||(b[d]=c[d]));return a.f.Bi(b)?!1:b}return a.f.Bi(this.changed)?!1:this.changed};a.f.j("Model.prototype.changedAttributes",{B8:a.U.prototype.B8});a.U.prototype.T9=function(c){return void 0!==c?a.U.pS(this.changed)&&this.changed.hasOwnProperty(c):a.U.pS(this.changed)};a.f.j("Model.prototype.hasChanged",{T9:a.U.prototype.T9});a.U.prototype.destroy=
function(c){c=c||{};var b=c.wait,d,e=c.error,f=this,h,k;k=a.U.AQ(c);d=a.U.Tla(k);var g=this.aH();k.success=function(e){k.xhr&&(c.xhr=k.xhr);if(g){var h=a.Wa.Hd(e)&&!a.Wa.Bi(e)?JSON.parse(e):e;g.Yra(h,null,e,!0)}b&&f.e2();a.U.hR(f,e,k);d&&d.call(a.U.Qn(k,f),f,e,c)};k.error=function(b,d,h){f.vd(!1,a.xa.ga.ERROR,f,b,c);e&&e.apply(f,arguments)};if(!this.UM())return h=a.U.hK("delete",this,k),b||this.e2(),h;b||this.e2();d&&d.call(a.U.Qn(k,f),f,null,c);return!1};a.f.j("Model.prototype.destroy",{destroy:a.U.prototype.destroy});
a.U.prototype.Pja=function(c,b,d,e){this.vd(e,a.xa.ga.REQUEST,c,b,d)};a.U.prototype.e2=function(){this.vd(!1,a.xa.ga.DESTROY,this,this.collection,null)};a.U.hR=function(c,b,d){c.vd(!1,a.xa.ga.SYNC,c,b,d)};a.U.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};a.f.j("Model.prototype.toJSON",{toJSON:a.U.prototype.toJSON});a.U.prototype.BN=function(a){return this.eaa[a]};
a.f.j("Model.prototype.previous",{BN:a.U.prototype.BN});a.U.prototype.Tya=function(){return this.eaa};a.f.j("Model.prototype.previousAttributes",{Tya:a.U.prototype.Tya});a.U.prototype.uv=function(c,b,d){return a.sync(c,b,d)};a.f.j("Model.prototype.sync",{uv:a.U.prototype.uv});a.U.hK=function(c,b,d){d=d||{};b.oauth&&(d.oauthHeader=b.oauth.getHeader());!d.dataType&&b.dataType&&(d.dataType=b.dataType);!d.jsonpCallback&&b.jsonpCallback&&(d.jsonpCallback=b.jsonpCallback);if("create"===c||"patch"===c||
"update"===c)d.baa=b.parseSave.call(b,"patch"===c?d.attrs:d.saveAttrs);var e=null;b instanceof a.U&&(e=b.Gk());var f={};if(d)for(var h in d)f[h]=d[h];e=a.U.Fca(e,b,d);for(h in e)f[h]=e[h];d.xhr=b.sync(c,b,f);f.xhr&&(d.xhr=f.xhr);return d.xhr};a.U.Fca=function(c,b,d){b=b instanceof a.t?b.vBa(d):{};c&&(b.recordID=c);return b};a.uv=function(c,b,d){function e(a){b.Pja(b,a,d,d.silent);return a}d=d||{};var f,h=d.success,k=d.error;f=b.customURL;if("create"===c.valueOf())return c=(c=b.$Wa())?c:a.U.Dv(b,"url"),
f=new a.dc(c,f),e(f.h_a(d.baa,k,d,b));if("read"===c.valueOf()){if(b instanceof a.U)return c=d.url?d.url:a.U.Dv(b,"url"),f=new a.dc(c,f),e(f.z9(h,k,b.Gk(),d,a.U.Qn(d,b)));c=b.Gba(d);f=new a.dc(c,f);return e(f.V1a(h,k,d,b))}f=new a.dc(a.U.Dv(b,"url"),f);var g=null;b instanceof a.U&&(g=b.Gk());return"update"===c.valueOf()?e(f.jAa(h,g,d.baa,k,d,b,!1)):"patch"===c.valueOf()?e(f.jAa(h,g,d.baa,k,d,b,!0)):"delete"===c.valueOf()?e(f.L0a(g,k,d,b)):null};o_("sync",a.uv,a);a.U.XZa=function(a){if(!a.url)throw Error("The url property or function must be specified");
};a.ajax=function(c){arguments&&0<arguments.length&&a.U.XZa(arguments[0]);return g.ajax.apply(a,arguments)};o_("ajax",a.ajax,a);a.Ov=function(){this.name="URLError";this.message="No URL defined"};o_("URLError",a.Ov,a);a.Ov.prototype=Error();a.Ov.constructor=a.Ov;a.dc=function(a,b){this.JN=a;this.fq=b;g.support.cors=!0};a.dc.ZC="headers";a.dc.eM=function(c,b,d){var e;c=g.extend(!0,c,d);for(e in b)b.hasOwnProperty(e)&&"oauthHeader"!==e&&(c.hasOwnProperty(e)||(c[e]=b[e]),e===a.dc.ZC&&(c[e]=g.extend(!0,
c[e],b[e])));if(b.oauthHeader)for(e in c[a.dc.ZC]||(c[a.dc.ZC]={}),b.oauthHeader)b.oauthHeader.hasOwnProperty(e)&&(c[a.dc.ZC].hasOwnProperty(e)||(c[a.dc.ZC][e]=b.oauthHeader[e]));return c};a.dc.prototype.V1a=function(c,b,d,e){d=d||{};var f="jsonp"===d.dataType,h=this.TJ("read",this.JN,this.fq,null,e,d);c={crossDomain:d.crossDomain||!f,dataType:this.sR(d),jsonpCallback:d.jsonpCallback,context:null!==e?e:this,success:c,error:b};c=this.bQ(c);c=a.dc.eM(c,d,h);d.xhr=this.ajax(c,e);return d.xhr};a.dc.prototype.bQ=
function(c){c[a.dc.ZC]={"Accept-Language":this.jk()};return c};a.dc.prototype.z9=function(c,b,d,e,f){e=e||{};var h="jsonp"===e.dataType;d=this.TJ("read",this.JN,this.fq,d,f,e);c={crossDomain:e.crossDomain||!h,dataType:this.sR(e),jsonpCallback:e.jsonpCallback,context:null!==f?f:this,success:c,error:b};c=this.bQ(c);c=a.dc.eM(c,e,d);e.xhr=this.ajax(c,f);return e.xhr};a.dc.prototype.jAa=function(c,b,d,e,f,h,k){f=f||{};var g="jsonp"===f.dataType;b=this.TJ(k?"patch":"update",this.JN,this.fq,b,h,f);k=a.dc.FD(f);
c={crossDomain:f.crossDomain||!g,contentType:this.TMa(f),dataType:this.sR(f),jsonpCallback:f.jsonpCallback,data:this.Lc(JSON.stringify(d),f,b),emulateHTTP:k,emulateJSON:a.dc.GD(f),success:c,error:e,context:null!==h?h:this};c=this.bQ(c);c=a.dc.eM(c,f,b);c=a.dc.Iga(k,c);f.xhr=this.ajax(c,h);return f.xhr};a.dc.Iga=function(a,b){if(a){var d=b.beforeSend;b.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",b.Co);if(d)return d.apply(this,arguments)}}return b};a.dc.prototype.Lc=function(c,
b,d){return a.dc.GD(b)?(b={_method:d.Co?d.Co:d.type},c&&(b.model=c),b):c};a.dc.prototype.nNa=function(c,b){if(b.type)return{method:b.type};var d=null;"create"===c&&(d="POST");"delete"===c&&(d="DELETE");"patch"===c&&(d="PATCH");"update"===c&&(d="PUT");if(a.dc.FD(b)){var e={method:"POST"};e.Co=d;return e}null===d&&(d="GET");return{method:d}};a.dc.FD=function(c){return c.emulateHTTP||a.emulateHTTP};a.dc.GD=function(c){return c.emulateJSON||a.emulateJSON};a.dc.prototype.TJ=function(c,b,d,e,f,h){var k=
this.nNa(c,h);if(g.isFunction(d)){c=d.call(this,c,f,a.U.Fca(e,f,h));if(a.Wa.Hd(c))return b={url:c,type:k.method},k.Co&&(b.Co=k.Co),b;if(c)return c.url=c.hasOwnProperty("url")?c.url:b,c.hasOwnProperty("type")||(c.type=k.method),!c.hasOwnProperty("data")&&k.Co&&(c.Co=k.Co),c}b={url:a.U.Dv(null,b),type:k.method};k.Co&&(b.Co=k.Co);return b};a.dc.prototype.L0a=function(c,b,d,e){d=d||{};var f="jsonp"===d.dataType;c=this.TJ("delete",this.JN,this.fq,c,e,d);var h=a.dc.FD(d);b={crossDomain:d.crossDomain||!f,
success:d.success,error:b,context:null!==e?e:this,emulateHTTP:h,emulateJSON:a.dc.GD(d)};(f=this.Lc(null,d,c))&&(b.data=f);b=a.dc.eM(b,d,c);b=a.dc.Iga(h,b);d.xhr=this.ajax(b,e);return d.xhr};a.dc.prototype.h_a=function(c,b,d,e){d=d||{};var f=JSON.stringify(c),h="jsonp"===d.dataType;c=this.TJ("create",this.JN,this.fq,null,e,d);var k=a.dc.FD(d);b={crossDomain:d.crossDomain||!h,contentType:d.contentType||"application/json",dataType:this.sR(d),jsonpCallback:d.jsonpCallback,data:this.Lc(f,d,c),success:d.success,
error:b,emulateHTTP:k,emulateJSON:a.dc.GD(d),context:null!==e?e:this};b=this.bQ(b);b=a.dc.eM(b,d,c);d.xhr=this.ajax(b,e);return d.xhr};a.dc.prototype.sR=function(c){return a.dc.GD(c)&&!a.dc.FD(c)?"application/x-www-form-urlencoded":c.dataType||"json"};a.dc.prototype.TMa=function(c){return a.dc.GD(c)&&!a.dc.FD(c)?"application/x-www-form-urlencoded":c.contentType||"application/json"};a.dc.prototype.jk=function(){return a.ra.jk()};a.dc.prototype.ajax=function(c,b){if(null===c.url||void 0===c.url)throw new a.Ov;
var d=a.ajax(c);b.cga&&b.cga(d);return d};a.md=function(c,b){b=b||{};a.md._init(this,b,c||"Authorization")};o_("OAuth",a.md,a);a.f.va(a.md,a.f,"oj.OAuth");a.md.prototype.Init=function(){a.md.N.Init.call(this)};a.md.prototype.Hva=function(){var a={};this.Ax.access_token||this.D8();a[this.gs.bua]="Bearer "+this.Ax.access_token;return a};a.f.j("OAuth.prototype.getHeader",{Hva:a.md.prototype.Hva});a.md.prototype.pxa=function(){return this.Ax.x8a?!0:!1};a.f.j("OAuth.prototype.isInitialized",{pxa:a.md.prototype.pxa});
a.md.prototype.D8=function(){var c={},b=this;c[b.gs.bua]="Basic "+a.md.UHa(b.gs.client_id+":"+b.gs.client_secret);g.ajax({type:"POST",async:!1,url:this.gs.bearer_url,data:"grant_type\x3dclient_credentials",headers:c,success:function(c){a.md.dK(b.Ax,c)},error:function(b){throw Error(b.responseText);}})};a.f.j("OAuth.prototype.clientCredentialGrant",{D8:a.md.prototype.D8});a.md.prototype.zza=function(c){a.md.dK(this.Ax,c)};a.f.j("OAuth.prototype.setAccessTokenResponse",{zza:a.md.prototype.zza});a.md.prototype.mva=
function(){return this.Ax};a.f.j("OAuth.prototype.getAccessTokenResponse",{mva:a.md.prototype.mva});a.md.prototype.oua=function(){a.md.rha(this.Ax)};a.f.j("OAuth.prototype.cleanAccessTokenResponse",{oua:a.md.prototype.oua});a.md.prototype.yza=function(c){a.md.dK(this.gs,c)};a.f.j("OAuth.prototype.setAccessTokenRequest",{yza:a.md.prototype.yza});a.md.prototype.lva=function(){return this.gs};a.f.j("OAuth.prototype.getAccessTokenRequest",{lva:a.md.prototype.lva});a.md.prototype.nua=function(){a.md.rha(this.gs)};
a.f.j("OAuth.prototype.cleanAccessTokenRequest",{nua:a.md.prototype.nua});a.md._init=function(c,b,d){c.Init();c.gs={};c.Ax={};b.access_token?a.md.dK(c.Ax,b):b.client_id&&b.client_secret&&b.bearer_url&&a.md.dK(c.gs,b);c.gs.bua=d};a.md.dK=function(a,b){var d;b=b||{};for(d in b)a[d]=b[d]};a.md.rha=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};a.md.UHa=function(a){var b,d,e,f,h=0,k=0,g=[];do b=a.charCodeAt(h++),d=a.charCodeAt(h++),e=a.charCodeAt(h++),f=b<<
16|d<<8|e,b=f>>18&63,d=f>>12&63,e=f>>6&63,f&=63,g[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f);while(h<a.length);g=g.join("");b=a.length%3;return(b?g.slice(0,b-3):g)+"\x3d\x3d\x3d".slice(b||3)};a.t=function(c,b){a.t.xK||
a.t._init(this,c,b,null)};o_("Collection",a.t,a);a.f.va(a.t,a.f,"oj.Collection");a.t.prototype.Xo=null;a.f.j("Collection.prototype.model",{Xo:a.t.prototype.Xo});a.t.prototype.qya=function(a){var b=this.model;return b&&a?a[b.idAttribute||b.prototype.idAttribute||"id"]:null};a.f.j("Collection.prototype.modelId",{qya:a.t.prototype.qya});a.t.prototype.length=void 0;a.f.j("Collection.prototype.length",{length:a.t.prototype.length});a.t.prototype.Ls=void 0;a.f.j("Collection.prototype.models",{Ls:a.t.prototype.Ls});
a.t.prototype.Qd=[];a.t.prototype.url=null;a.f.j("Collection.prototype.url",{url:a.t.prototype.url});a.t.prototype.Gx=[];a.f.j("Collection.prototype.changes",{Gx:a.t.prototype.Gx});a.t.prototype.fq=null;a.f.j("Collection.prototype.customURL",{fq:a.t.prototype.fq});a.t.prototype.Mua=null;a.f.j("Collection.prototype.customPagingOptions",{Mua:a.t.prototype.Mua});a.t.prototype.yxa=void 0;a.f.j("Collection.prototype.lastFetchSize",{yxa:a.t.prototype.yxa});a.t.prototype.U9=!1;a.f.j("Collection.prototype.hasMore",
{U9:a.t.prototype.U9});a.t.prototype.Qaa=void 0;a.f.j("Collection.prototype.totalResults",{Qaa:a.t.prototype.Qaa});a.t.prototype.xxa=void 0;a.f.j("Collection.prototype.lastFetchCount",{xxa:a.t.prototype.xxa});a.t.prototype.rya=-1;a.f.j("Collection.prototype.modelLimit",{rya:a.t.prototype.rya});a.t.prototype.offset=void 0;a.f.j("Collection.prototype.offset",{offset:a.t.prototype.offset});a.t.prototype.fetchSize=-1;a.f.j("Collection.prototype.fetchSize",{fetchSize:a.t.prototype.fetchSize});a.t.prototype.Iaa=
1;a.f.j("Collection.prototype.sortDirection",{Iaa:a.t.prototype.Iaa});a.t.prototype.Go=null;a.f.j("Collection.prototype.comparator",{Go:a.t.prototype.Go});a.t.prototype.Init=function(){a.t.N.Init.call(this)};a.t.extend=function(c,b){a.t.xK=!0;var d=new a.t;a.t.xK=!1;g.extend(d,this.prototype);var e;e=c&&c.constructor&&c.hasOwnProperty("constructor")?c.constructor:function(b,d){a.t._init(this,b,d,c)};if(b)for(var f in b)b.hasOwnProperty(f)&&(e[f]=b[f]);if(c)for(f in c)c.hasOwnProperty(f)&&(d[f]=c[f]);
g.extend(e,this);e.prototype=d;e.extend=a.t.extend;return e.prototype.constructor=e};o_("Collection.extend",a.t.extend,a);a.t._init=function(c,b,d,e){var f,h;c.Init();a.xa.DY(c);if(e)for(f in e)e.hasOwnProperty(f)&&(c[f]=e[f]);d=d||{};h=["comparator","customPagingOptions","customURL",a.t.$g,"model","modelLimit","sortDirection","url"];for(f=0;f<h.length;f++)d.hasOwnProperty(h[f])&&void 0!==d[h[f]]&&(c[h[f]]=d[h[f]]);void 0===c.Ip(null)&&c.pX(-1);void 0===c.modelLimit&&c.zaa(-1);c.hasMore=!1;c.Mo=0;
c.TA([],!0);d.parse&&(b=c.parse(b));null!=b&&(d.zya=!0,f=b instanceof Array?b:[b],c.jr(f,d,!0,!1));c.Tr();b||(c.totalResults=void 0);e&&e.initialize&&e.initialize.call(c,b,d)};a.t.prototype.on=function(){};a.t.prototype.dt=function(){};a.t.prototype.vd=function(){};a.t.prototype.Pja=function(c,b,d,e){this.vd(e,a.xa.ga.REQUEST,c,b,d)};a.t.prototype.GWa=function(){this.changes=[]};a.t.prototype.J6=function(a,b){for(var d=a;d<a+b;d++)-1===this.changes.indexOf(d)&&this.changes.push(d)};a.t.prototype.TA=
function(a,b){this.models=a;if(b)this.Qd=[],this.GWa();else for(var d=0;d<a.length;d++)a[d]&&this.Qd.push(d)};a.t.prototype.Ze=function(){return this.models};a.t.prototype.Rf=function(){return this.Ze().length};a.t.prototype.sUa=function(a){return a<this.Rf()||this.Qb()&&(!this.Kw()||0===this.Rf())?!1:!0};a.t.prototype.Kw=function(){return a.t.St(this.totalResults)};a.t.St=function(a){return null!=a};a.t.prototype.aVa=function(a){this.Ze().push(a);this.Qd.push(this.Rf()-1);this.J6(this.Rf()-1,1)};
a.t.prototype.bVa=function(a){this.f5(a);this.aVa(a);this.Mo++;a.tH(this.Rf()-1)};a.t.prototype.Zpa=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.Mo--};a.t.prototype.Jsa=function(a,b,d){for(var e=a;e<a+b;e++)this.Cqa(this.Cd(e));void 0===d?(this.Zpa(this.Ze().splice(a,b)),this.Isa(a,a+b-1)):(this.Zpa(this.Ze().splice(a,b,d)),this.Isa(a,a+b-1),this.YRa(a),this.f5(d));this.J6(a,b);0>this.Mo&&(this.Mo=0);this.Xpa(a)};a.t.prototype.Cd=function(a){return this.Ze()[a]};a.t.prototype.Xpa=function(a){for(var b,
d=0;d<this.Qd.length;d++)b=this.Qd[d],b>=a&&this.Cd(b)&&this.Cd(b).tH(b)};a.t.prototype.Cqa=function(a){if(a){var b=a.faa;a=a.o4a;b?b.RY(a):this.head=a;a?a.MO(b):this.tail=b}};a.t.prototype.f5=function(a){a.RY(this.head);this.head?this.head.MO(a):this.tail=a;a.MO(null);this.head=a};a.t.prototype.QXa=function(a){-1===this.Qd.indexOf(a)&&this.Qd.push(a)};a.t.prototype.YRa=function(a){for(var b=0;b<this.Qd.length;b++)this.Qd[b]>=a&&this.Qd[b]++;this.Qd.push(a)};a.t.prototype.Isa=function(a,b){void 0===
b&&(b=a);this.Cha(a,b);for(var d=b-a+1,e=0;e<this.Qd.length;e++)this.Qd[e]>b&&(this.Qd[e]-=d)};a.t.prototype.Cha=function(a,b){void 0===b&&(b=a);for(var d=a;d<=b;d++){var e=this.Qd.indexOf(a);-1<e&&this.Qd.splice(e,1)}};a.t.prototype.iU=function(a,b){var d=this.Cd(a);this.Cqa(d);d||this.Mo++;this.J6(a,1);if(this.Ze()[a]=b)this.QXa(a),b.tH(a),this.f5(b)};a.t.prototype.PIa=function(a){var b=this.tail,d,e,f=0;for(this.tail=null;b&&f<a;)d=b.Nba(),(e=this.Cd(d))&&e.T9()?(this.tail||(this.tail=b),b=b.faa):
(this.Mo--,-1<d&&(this.iU(d,void 0),this.Cha(d,d)),b.RY(null),b=b.MO(null),f++);this.tail||(this.tail=b);0>this.Mo&&(this.Mo=0);0===this.Mo&&(this.tail=this.head=null)};a.t.prototype.nL=function(){this.Mo=0;this.tail=this.head=null};a.t.prototype.xA=function(a){if(this.Qb()){var b=this.nla();-1<b&&this.Mo+a>b&&this.PIa(this.Mo+a-b)}};a.t.prototype.clone=function(){return this.Eha(!0)};a.f.j("Collection.prototype.clone",{clone:a.t.prototype.clone});a.t.prototype.Eha=function(a){var b=new this.constructor,
d;this.Qb()&&(b=this.BJa(b),b.s6());b=this.d1(b);if(a){var e=[];for(a=0;a<this.Qd.length;a++)e.push(this.Qd[a]);e.sort(function(b,a){return b-a});var f;for(a=0;a<e.length;a++)f=e[a],(d=this.Ht(f,null,!0,!1))&&b.jr(d.clone(),{at:f},!0,!1)}return b};a.t.prototype.d1=function(a){var b=["comparator","model","modelId"],d,e;for(e=0;e<b.length;e++)d=b[e],a[d]=this[d];return a};a.t.prototype.BJa=function(c){var b=["totalResults","hasMore",a.t.$g],d,e;for(e=0;e<b.length;e++)d=b[e],c[d]=this[d];return c};a.t.prototype.Hg=
function(){return this.length};a.t.prototype.Tr=function(){var a=this.Rf();this.length=a;this.Qb()||(this.totalResults=a)};a.t.j1=function(a,b,d){return a.model?g.isFunction(a.model)?new a.model(b,d):new a.model.constructor(b,d):null};a.t.prototype.NK=function(c,b,d){var e=null;b=b||{};b.n3a=d;c instanceof a.U?e=c:this.model?e=a.t.j1(this,c,b):(b.collection=this,e=new a.U(c,b));return b.validate&&e.validate&&(c=e.validate(e.attributes))?(b.validationError=c,this.vd(!1,a.xa.ga.INVALID,e,c,b),null):
e};a.t.prototype.add=function(a,b){this.xA(1);return this.YJ(this.jr(a,b,!1,(b||{}).deferred))};a.f.j("Collection.prototype.add",{add:a.t.prototype.add});a.t.prototype.jr=function(c,b,d,e){function f(c,e,f,h,k){var g,l=null;!t&&r&&f?(w=f.rBa(e,c.comparator,p),l=f):(t||(g=d?h.UM()?void 0:c.U2(h):c.U2(h))&&d&&m!==g.index&&a.D.warn("Duplicate ID fetched or added without merging, the id \x3d "+g.Gk()),void 0===g?(void 0===m?(c.bVa(h),n=c.Rf()-1,c.Cd(n).LO()):(n=m,c.Qb()&&d?c.iU(n,h):c.Jsa(n,0,h),c.Cd(n).LO(),
m+=1),void 0===h.aH()&&h.sH(c),c.Tr(),c.fTa(h),v=!0,l=h):l=g);d&&(b=b||{},b.fillIn=!0);e=b.comparator||c.r4();(!d||d&&e)&&w&&void 0===g&&!u&&void 0===m&&1<c.Hg()&&(-1<n&&(q=c.Cd(n).cid),g={},a.oc.Ed(g,b),g.add=!0,c.sort(g),-1<n&&(n=c.Qb()?-1:c.indexOf(c.e9(q),k)));v&&(b.at&&(b.index=n),h?(h.vd(p,a.xa.ga.ADD,h,c,b),x.push(h)):(f.vd(p,a.xa.ga.ADD,f,c,b),x.push(f)));return l}function h(c,e,h){v=!1;var k=c.NK(e,b,!1),g=null,l=null;if(null!=k){n=-1;k.Sq();g=e instanceof a.U?e:k;if(h)return t?new Promise(function(b){var a=
f(c,g,void 0,k,h);y.push(a);b(a)}):c.gn(g,{silent:!0},h,!0).then(function(b){l=b.m;b=f(c,g,l,k,h);y.push(b)});!t&&r&&(l=d?c.U2(g):c.get(g));(e=f(c,g,l,k,h))&&y.push(e)}else y.push(!1)}function k(a,c){return a.parse&&b.parse&&!b.zya?a.parse(c):c}b=b||{};var g=[],m=b.at,p=b.silent,t=b.force,s,n,q,r=b.merge||!1,u=b.sort,w=!0,v=!1,x=[],y=[];void 0!==m&&0>m&&(m+=this.Hg()+1);c instanceof Array?g=c:g.push(c);if(!d&&(this.Qb()||e)){var z=this;return new Promise(function(c,d){function e(b){return new Promise(function(a,
c){h(z,g[b],!0).then(function(){a(b+1)},c)})}var f=Promise.resolve(0);g=k(z,g);for(s=0;s<g.length;s++)f=f.then(e);f.then(function(){0<x.length&&z.vd(b.silent,a.xa.ga.ALLADDED,z,x,b);c(a.t.x6(y))},d)})}g=k(this,g);for(s=0;s<g.length;s++)h(this,g[s],!1);0<x.length&&this.vd(b.silent,a.xa.ga.ALLADDED,this,x,b);return a.t.x6(y)};a.t.x6=function(a){return 1===a.length?a[0]:a};a.t.prototype.r4=function(){return a.t.St(this.comparator)};a.t.prototype.sort=function(c){c=c||{};var b=c.silent,d=this.comparator,
e;if(!this.r4())return null;if(this.Qb()){var f=this.totalResults;this.Kw()?this.TA(Array(f),!0):(this.TA([],!0),this.nL(),this.Tr());f=c.add?{add:!0}:null;this.vd(b,a.xa.ga.SORT,this,f,null);b=c.startIndex;return void 0!==b&&null!==b?this.IG(b,this.Ip(c)):null}e=this;this.Ze().sort(function(b,c){return a.t.Oca(b,c,d,e,e)});this.Xpa(0);f=c.add?{add:!0}:null;this.vd(b,a.xa.ga.SORT,this,f,null);return null};a.f.j("Collection.prototype.sort",{sort:a.t.prototype.sort});a.t.nb=function(c,b){return c instanceof
a.U?c.get(b):a.U.Dv(c,b)};a.t.Oca=function(c,b,d,e,f){var h,k,l;if(g.isFunction(d)){if(1===d.length){h=d.call(f,c);k=d.call(f,b);h=a.Wa.Hd(h)?h.split(","):[h];var m=a.Wa.Hd(k)?k.split(","):[k];for(l=0;l<h.length;l++)if(k=a.t.Lt(h[l],m[l],e.sortDirection),0!==k)return k}return d.call(f,c,b)}if(a.Wa.Hd(d))for(d=d.split(","),l=0;l<d.length;l++)if(h=a.t.nb(c,d[l]),k=a.t.nb(b,d[l]),k=a.t.Lt(h,k,e.sortDirection),0!==k)return k;return 0};a.t.prototype.Tza=function(c,b){var d=b?b:this.comparator,e;if(!d)return-1;
this.$j("sortedIndex");e=this;return a.t.$La(this.Ze(),c,function(b,c){var k,l;if(g.isFunction(d)){if(1===d.length){k=d.call(e,b);l=d.call(e,c);k=a.Wa.Hd(k)?k.split(","):[k];l=a.Wa.Hd(l)?l.split(","):[l];var m,p;for(p=0;p<k.length;p++)if(m=a.t.Lt(k[p],l[p],e.sortDirection),0!==m)return m}return d.call(e,b,c)}return a.Wa.Hd(d)?(k=b.get(d),l=c.get(d),a.t.Lt(k,l,e.sortDirection)):0})};a.f.j("Collection.prototype.sortedIndex",{Tza:a.t.prototype.Tza});a.t.$La=function(a,b,d){function e(f,h){var k,g;if(f>
h)return-1;k=b.Qy();g=b.Gk();if(a[f].Yy(g,k))return f;if(a[h].Yy(g,k))return h;k=Math.floor((h+f)/2);return-1===d(a[k],b)?e(f+1,k):1===d(a[k],b)?e(k,h-1):k}return e(0,a.length-1)};a.t.Lt=function(a,b,d){if(-1===d){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};a.t.prototype.unshift=function(c,b){var d={};a.oc.Ed(d,b||{});d.at||(d.at=0);this.xA(1);return this.YJ(this.jr(c,d,!1,d.deferred))};a.f.j("Collection.prototype.unshift",{unshift:a.t.prototype.unshift});a.t.prototype.YJ=
function(a){return g.isFunction(a.then)?this.Dh(function(){return a}):a};a.t.prototype.shift=function(c){c=c||{};var b=this.Pj(c),d;if(this.Qb()||b){var e=this;return this.at(0,c).then(function(b){d=e.OA(b,0,c);e.vd(c.silent,a.xa.ga.ALLREMOVED,e,[d],c);return d})}d=this.OA(this.at(0),0,c);this.vd(c.silent,a.xa.ga.ALLREMOVED,this,[d],c);return d};a.f.j("Collection.prototype.shift",{shift:a.t.prototype.shift});a.t.prototype.jW=function(a){void 0===a&&(a=1);this.$j("initial");var b=[],d;for(d=0;d<this.Hg()-
a;d+=1)b.push(this.at(d));return b};a.f.j("Collection.prototype.initial",{jW:a.t.prototype.jW});a.t.prototype.Pj=function(a){return(a||{}).deferred};a.t.prototype.last=function(a,b){var d=this.Pj(b);void 0===a&&(a=1);if(1===a){var e=this.Rf();0===e&&(e=a);return 0<e?this.at(e-1,d):null}var f=[],e=this.Hg();if(d||this.Qb()){var h=e-a;0>h&&(h=0);0===e&&(e=a);var k=this;return this.Dh(function(){return k.zC(h,e)})}for(d=e-a;d<e;d+=1)f.push(this.at(d));return f};a.f.j("Collection.prototype.last",{last:a.t.prototype.last});
a.t.prototype.zC=function(a,b){var d=[],e,f=this;return new Promise(function(h,k){function g(a){return f.Qb()&&f.Kw()&&a>=f.totalResults?Promise.resolve(a+1):new Promise(function(b,c){f.v1(a,null).then(function(c){d.push(c);b(a+1)},c)})}var m=Promise.resolve(a);for(e=a;e<b;e++)m=m.then(g);m.then(function(){h(d)},k)})};a.t.prototype.yka=function(c){return void 0===c||null===c?this[a.t.$g]:c};a.t.prototype.rIa=function(){var c=this.lastFetchCount;if(void 0===c||null===c)c=this[a.t.$g];return void 0===
this.offset||null===this.offset?c:this.offset+c};a.t.prototype.next=function(c,b){b=b||{};b[a.t.$g]=this.yka(c);var d=this.rIa(),e=this.Hg();if(0===e&&0<b[a.t.$g])d=0;else if(d>=e)return b.success&&b.success.call(a.U.Qn(b,this),this,null,b),null;b.startIndex=d;return this.fetch(b)};a.f.j("Collection.prototype.next",{next:a.t.prototype.next});a.t.prototype.sIa=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};a.t.prototype.BN=function(c,b){b=b||{};if(0===this.offset)return b.success&&
this.lastFetchCount&&b.success.call(a.U.Qn(b,this),this,null,b),null;b[a.t.$g]=this.yka(c);var d=this.sIa(b[a.t.$g]);0>d&&(b[a.t.$g]=this.offset,d=0);b.startIndex=d;return this.fetch(b)};a.f.j("Collection.prototype.previous",{BN:a.t.prototype.BN});a.t.prototype.zaa=function(a){this.modelLimit=a;this.xA(0)};a.f.j("Collection.prototype.setModelLimit",{zaa:a.t.prototype.zaa});a.t.prototype.nla=function(){return this.modelLimit};a.t.prototype.pX=function(c){this[a.t.$g]=c};a.f.j("Collection.prototype.setFetchSize",
{pX:a.t.prototype.pX});a.t.prototype.qza=function(a,b){var d=this.Pj(b);void 0===a&&(a=1);var e=[];if(this.Qb()||d){var f=this;return this.Dh(function(){return f.zC(a,f.Hg())})}for(d=a;d<this.Hg();d+=1)e.push(this.at(d));return e};a.f.j("Collection.prototype.rest",{qza:a.t.prototype.qza});a.t.prototype.remove=function(c,b){b=b||{};var d=[],e;c instanceof Array?d=c:d.push(c);var f=[];for(e=d.length-1;0<=e;e-=1)f.unshift(this.OA(d[e],-1,b));this.vd(b.silent,a.xa.ga.ALLREMOVED,this,d,b);return a.t.x6(f)};
a.f.j("Collection.prototype.remove",{remove:a.t.prototype.remove});a.t.prototype.OA=function(c,b,d){d=d||{};c=-1==b?this.gn(c):a.t.$t(b,c);var e=d.silent;b=c.index;if(-1<b){var f=c.m;void 0!==f&&f.aH()===this&&f.sH(null);this.Jsa(b,1);this.Tr();var h={};a.oc.Ed(h,d);h.index=b;void 0!==f&&f.vd(e,a.xa.ga.REMOVE,f,this,h);this.vta(f)}return c.m};a.t.prototype.vta=function(a){void 0!==a&&a.off(null,null,this)};a.t.prototype.fTa=function(c){c.dt(a.xa.ga.ALL,this.ETa,this,!1,!0)};a.t.prototype.ETa=function(c,
b,d,e){c===a.xa.ga.DESTROY&&this.remove(b);void 0!==d&&d instanceof a.t&&d!==this||(Array.prototype.slice.call(arguments),this.vd(e&&e.silent,c,b,d,e))};a.t.prototype.refresh=function(c){c=c||{};var b=this;return this.Dh(function(){return new Promise(function(d,e){if(!b.Qb()){var f=void 0!==c.silent&&c.silent;try{b.reset(null,{silent:!0});var h={},k;for(k in c)c.hasOwnProperty(k)&&(h[k]=c[k]);h.success=function(c,e,h){b.vd(f,a.xa.ga.REFRESH,b,h,null);d({collection:c,response:e,options:h})};h.error=
function(d,f,h){e(a.t.YI(d,f,h,b,c,!1))};b.fetch(h);return}catch(g){if(g instanceof a.Ov){b.vd(f,a.xa.ga.REFRESH,b,c,null);d({collection:b,options:c});return}throw g;}}h=c.startIndex;b.TA([],!0);b.nL();b.totalResults=void 0;b.Tr();f=void 0!==c.silent&&c.silent;b.vd(f,a.xa.ga.REFRESH,b,c,null);if(void 0===h||null===h)h=0;void 0!==h&&null!==h?b.csa(h,b.Ip(c)).then(function(a){d(a)},function(a){e(a)}):d(void 0)})})};a.f.j("Collection.prototype.refresh",{refresh:a.t.prototype.refresh});a.t.prototype.reset=
function(c,b){var d={};a.oc.Ed(d,b||{});d.previousModels=this.Ze();for(var e,f=0;f<this.Qd.length;f++)if(e=this.Qd[f],e=this.Cd(e))this.vta(e),e.sH(null);this.TA([],!0);this.nL();f=void 0!==d.silent&&d.silent;if(!c)return this.Tr(),this.totalResults=void 0,this.vd(f,a.xa.ga.RESET,this,d,null),null;e=null;d.parse&&(c=this.parse(c));this.xA(c instanceof Array?c.length:1);d.zya=!0;e=this.jr(c,d,!0,!1);this.Tr();this.vd(f,a.xa.ga.RESET,this,d,null);return this.YJ(e)};a.f.j("Collection.prototype.reset",
{reset:a.t.prototype.reset});a.t.prototype.at=function(a,b){return this.Ht(a,b,!1,this.Pj(b))};a.f.j("Collection.prototype.at",{at:a.t.prototype.at});a.t.prototype.Ht=function(a,b,d,e){0>a&&(a+=this.Hg());if(0>a||this.sUa(a))return d||!this.Qb()&&!e?null:this.Dh(function(){return Promise.resolve(null)});var f=this;return d||!this.Qb()&&!e?this.Cd(a):this.Dh(function(){return f.v1(a,b)})};a.t.prototype.whenReady=function(){return this.hx?this.hx:Promise.resolve()};a.f.j("Collection.prototype.whenReady",
{whenReady:a.t.prototype.whenReady});a.t.prototype.Dh=function(c){var b=this;void 0===this.hx&&(this.YK=0,this.hx=Promise.resolve());this.YK++;return this.hx=this.hx.then(c.bind(b)).then(function(c){b.YK--;0===b.YK&&(b.hx=void 0,b.vd(!1,a.xa.ga.READY,b,null,null));return c},function(a){b.YK--;0===b.YK&&(b.hx=void 0);return Promise.reject(a)})};a.t.prototype.cga=function(a){if(a&&a.abort){void 0===this.dm&&(this.dm=[]);var b=this;this.dm.push(a);a.done(function(){var d=b.dm?b.dm.indexOf(a):-1;-1<d&&
b.dm.splice(d,1)})}};a.t.prototype.abort=function(){var a=this;return this.dm&&0<this.dm.length?new Promise(function(b){for(var d=a.dm.length-1;0<=d;d--)a.dm[d].then(function(e,f){"abort"===f&&(a.dm.splice(d,1),0===a.dm.length&&a.whenReady().then(function(){b(null)},function(){b(null)}))},function(){a.dm.splice(d,1);0===a.dm.length&&a.whenReady().then(function(){b(null)},function(){b(null)})}),a.dm[d].abort()}):Promise.resolve()};a.f.j("Collection.prototype.abort",{abort:a.t.prototype.abort});a.t.prototype.v1=
function(c,b){var d=this,e=d.Cd(c);return void 0===e?new Promise(function(e,h){var k={};a.oc.Ed(k,b||{});k.context=d;k.startIndex=c;k.error=function(c,e,f){h(a.t.YI(c,e,f,d,b,!1))};k.success=function(){e(d.Cd(c))};d.ki(k,-1,!1)}):new Promise(function(a){a(e)})};a.t.prototype.e9=function(a){for(var b=this.Ze(),d,e=null,f=0;f<this.Qd.length;f++)if(d=this.Qd[f],b[d]&&a===b[d].cid){e=b[d];break}if(e)return e;if(this.Qb())throw Error("Not found locally and not supported by server for virtual collections");
return null};a.f.j("Collection.prototype.getByCid",{e9:a.t.prototype.e9});a.t.prototype.get=function(a,b){var d=this.gn(a,b,this.Pj(b));if(d){if(g.isFunction(d.then))return this.Dh(function(){return new Promise(function(a,b){d.then(function(b){a(b.m)},function(a){b(a)})})});if(this.Qb())return this.Dh(function(){return new Promise(function(a){a(d.m)})});if(d.hasOwnProperty("m"))return d.m}return null};a.f.j("Collection.prototype.get",{get:a.t.prototype.get});a.t.prototype.U2=function(a){return(a=
this.dla(a))?a.m:null};a.t.prototype.dla=function(c){var b=c;c instanceof a.U?(b=c.Qy(),c=c.Gk()):a.t.St(c)&&void 0!==c.id&&(c=c.id);for(var d=null,e=this.Qd.length,f,h=this.Ze(),k,g=0;g<e;g++)if(k=this.Qd[g],f=h[k],void 0!==f&&f.Yy(c,b)){d=a.t.$t(k,f);break}return d?d:a.t.$t(-1,void 0)};a.t.prototype.gn=function(c,b,d,e){var f=c;void 0===e&&(e=!1);c instanceof a.U?(f=c.Qy(),c=c.Gk()):a.t.St(c)&&void 0!==c.id&&(c=c.id);for(var h=null,k=this.Ze(),g,m=0;m<this.Qd.length;m++)if(g=this.Qd[m],k[g]&&k[g].Yy(c,
f)){h=a.t.$t(g,k[g]);break}if(h)return d?new Promise(function(a){a(h)}):h;if(this.Qb()){if(void 0===c&&void 0!==f)return new Promise(function(b){b(a.t.$t(-1,void 0))});var p=this;return new Promise(function(d,h){var k={};a.oc.Ed(k,b||{});k.context=p;k.startID=c;k.error=function(c,d,e){h(a.t.YI(c,d,e,p,b,!1))};k.success=function(b,e){if(null!=e){var h=p.i3(),k=p.Cd(h);void 0!==k&&k.Yy(c,f)?d(a.t.$t(h,k)):d(a.t.$t(-1,void 0))}else d(a.t.$t(-1,void 0))};p.ki(k,-1,e)})}var t=a.t.$t(-1,void 0);return d?
new Promise(function(a){a(t)}):t};a.t.$t=function(a,b){return{index:a,m:b}};a.t.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};a.t.prototype.zIa=function(a,b,d){return this.Kw()&&d.start+d.count>=this.totalResults?!0:d.start===a&&d.count===b};a.t.prototype.IG=function(a,b){var d=this;return this.Dh(function(){return d.csa(a,b)})};a.f.j("Collection.prototype.setRangeLocal",{IG:a.t.prototype.IG});a.t.prototype.csa=
function(a,b){this.Qb()&&this.s6();var d=this.ER(a,b),e=this;if(this.zIa(a,b,d))return new Promise(function(a){a(d)});var f=this.nla();-1<f&&f<b&&(this.modelLimit=b);return new Promise(function(d,f){e.bsa(a,b,-1,{start:a,count:b},d,f,!0)})};a.t.prototype.bsa=function(c,b,d,e,f,h,k){var g=this,m=c+b;this[a.t.$g]&&this[a.t.$g]>b&&(m=this[a.t.$g]+c);var p=null;this.Qb()?(p=this.Hka(c,m),p>c&&(c=p,m=c+b,this[a.t.$g]&&this[a.t.$g]>b&&(m=this[a.t.$g]+c)),p={context:this,startIndex:c,fetchSize:m-c}):p={context:this};
p.error=function(b,c,d){h(a.t.YI(b,c,d,g,null,!1))};p.success=function(){var a=g.ER(e.start,e.count);if(k&&g.Kw()&&a.count<e.count){var d=a.start+a.count,m=c+(g.lastFetchCount?g.lastFetchCount:b);m<g.totalResults?g.bsa(m,b,d,e,f,h,k):f(a)}else f(a)};try{this.ki(p,d,-1<d)}catch(t){t instanceof a.Ov&&(d=g.ER(c,b),f(d))}};a.t.YI=function(c,b,d,e,f,h){var k=!1;f&&f.silent&&(k=f.silent);h&&a.U.SL(e,k,f,b,d,c);f=Error(b);f.xhr=c;f.error=d;f.collection=e;f.status=b;return f};a.t.prototype.ENa=function(a,
b){var d=this.Rf();return 0===d?a+b:a+b>d?d:a+b};a.t.prototype.rxa=function(a,b){var d=this.ER(a,b);return 0===this.Rf()?0===b:a===d.start&&(b===d.count||a+b>this.Rf())};a.f.j("Collection.prototype.isRangeLocal",{rxa:a.t.prototype.rxa});a.t.prototype.LJ=function(a,b){for(var d=[],e=this.Ze(),f=a+b,h=a;h<f;h++)d.push(e[h]);return d};a.t.prototype.ER=function(a,b){if(!this.Qb()){if(0<this.Rf()){if(a+b>this.Rf()){var d=this.Rf()-a;return{start:a,count:d,models:this.LJ(a,d)}}return{start:a,count:b,models:this.LJ(a,
b)}}return{start:a,count:0,models:[]}}d=this.ENa(a,b);if(!this.Kw()&&d<a+b)return{start:a,count:d-a,models:this.LJ(a,d-a)};if(0===d)return{start:a,count:0,models:[]};var e=this.Hka(a,d);if(-1<e)return{start:a,count:e-a,models:this.LJ(a,e-a)};a>d?b=0:a+b>d&&(b=d-a);return{start:a,count:b,models:this.LJ(a,b)}};a.t.prototype.Hka=function(a,b){for(var d=a;d<b;d++)if(void 0===this.Cd(d))return d;return-1};a.t.prototype.fetch=function(a){var b=this.ki(a,-1,!1);this.Dh(function(){return Promise.resolve(b)});
return b};a.f.j("Collection.prototype.fetch",{fetch:a.t.prototype.fetch});a.t.prototype.ki=function(c,b,d){function e(a,b,c){a.Qb()?c||a.s6():b.add||b.Yaa||a.reset(null,{silent:!0})}var f=c||{},h=f.success,k,g=f.error;f.set&&(f.Yaa=f.set?!0:!1);void 0===f.parse&&(f.parse=!0);k=this;f.error=function(b,d,e){a.U.SL(k,!1,c,d,e,b);g&&g.call(a.U.Qn(c,k),b,d,e)};f.success=function(g){var l;try{l=k.parse(g,c)}catch(t){a.t.PT(k,t,f.error,c);return}k.Yra(g,c,l,d);var s=null;if(f.add||k.model){e(k,f,d);try{q=
!1,-1===b&&(q=!0,b=k.i3()),s=k.XLa(l,b,q,f)}catch(n){a.t.PT(k,n,f.error,c);return}}else if(!d)if(k.Qb()){e(k,f,d);var q=!1;-1===b&&(q=!0,b=k.i3());s=k.cVa(l,b,q)}else f.Yaa?k.R6(l,!1,f,!1):k.reset(l,{silent:!0});k.Qb()&&s&&(k.lastFetchCount=s.length);k.vd(f.silent?!0:!1,a.xa.ga.SYNC,k,g,f);h&&h.call(a.U.Qn(c,k),k,g,f)};return this.xja(f)};a.t.prototype.cVa=function(a,b,d){var e;if(a){e=a instanceof Array?a:[a];a={};d&&this.xA(e.length);d=this.Qb();for(var f=null,h=0;h<e.length;h+=1)d&&(a={at:b},f=
this.Ht(b,null,!0,!1)),a.silent=!0,this.jr(e[h],a,!0,!1),this.Ht(b,null,!0,!1)!==f&&b++}return e};a.t.prototype.XLa=function(c,b,d,e){e=e||{};var f=e.parse,h=a.t.j1(this);if(c){var k=c instanceof Array?c:[c];c={};d&&this.xA(k.length);d=this.Qb();if(e.Yaa&&!d){for(var g=0;g<k.length;g+=1)b=h&&f?h.parse(k[g]):k[g],k[g]=b;this.R6(k,!1,e,!1)}else{e=null;for(var m=b,g=0;g<k.length;g+=1)b=h&&f?h.parse(k[g]):k[g],d&&(c={at:m},e=this.Ht(m,c,!0,!1)),c.silent=!0,this.jr(b,c,!0,!1),this.Ht(m,null,!0,!1)!==e&&
m++}}return k};a.t.PT=function(c,b,d,e){a.D.error(b.toString());d&&d.call(a.U.Qn(e,c),c,b,e)};a.t.prototype.TLa=function(c){var b=c||{},d=b.success,e,f;void 0===b.parse&&(b.parse=!0);f=this;b.success=function(h){var k,g,m=null,p=[];try{k=f.parse(h,c)}catch(t){a.t.PT(f,t,b.error,c);return}if(b.add||f.model)if(g=a.t.j1(f),k)for(m=k instanceof Array?k:[k],k=0;k<m.length;k+=1){if(g&&b.parse)try{e=g.parse(m[k])}catch(s){a.t.PT(f,s,b.error,c);return}else e=m[k];p.push(f.NK(e))}f.vd(!1,a.xa.ga.SYNC,f,h,
b);d&&d.call(a.U.Qn(c,f),f,p,b)};this.xja(b)};a.t.prototype.xja=function(c){try{return a.U.hK("read",this,c)}catch(b){throw a.U.SL(this,!1,c,null,b,null),b;}};a.t.prototype.s6=function(){var a=this.totalResults;void 0!==a&&this.Rf()!==a&&(this.TA(Array(a),!0),this.nL(),this.Tr())};a.t.prototype.Ip=function(c){c=c||{};return c[a.t.$g]||this[a.t.$g]};a.t.prototype.Qb=function(){return-1<this.Ip(null)};a.t.prototype.SR=function(c,b,d,e,f){c=parseInt(a.t.PR(c,b,d),10);return void 0===c||null===c||isNaN(c)?
e?e:f:c};a.t.prototype.tha=function(a){return-1===a?void 0:a};a.t.prototype.Yra=function(c,b,d,e){var f={};this.customPagingOptions&&((f=this.customPagingOptions.call(this,c))||(f={}));b=b||{};this.lastFetchSize=this.SR(f,c,"limit",b.fetchSize,this.fetchSize);this.offset=this.SR(f,c,"offset",b.startIndex,0);this.lastFetchCount=this.SR(f,c,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.tha(this.SR(f,c,"totalResults",this.totalResults,this.totalResults));this.hasMore=this.oNa(a.t.PR(f,
c,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);e||(this.totalResults=this.nHa(this.tha(parseInt(a.t.PR(f,c,"totalResults"),10)),this.hasMore,this.offset,parseInt(a.t.PR(f,c,"count"),10),d&&Array.isArray(d)?d.length:0));!this.Qb()&&this.totalResults&&this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.pX(this.lastFetchSize)};a.t.prototype.nHa=function(a,b,d,e,f){return!b&&isNaN(a)?(isNaN(e)?f:e)+d:this.totalResults};a.t.prototype.oNa=function(c,b,d,e){return a.t.St(c)?
c:void 0===e||null===e?!0:b+d>e?!1:!0};a.t.PR=function(a,b,d){return a.hasOwnProperty(d)?a[d]:b?b[d]:void 0};a.t.prototype.i3=function(){return a.t.St(this.offset)?this.offset:0};a.t.prototype.create=function(c,b){function d(b,d){b.save(c instanceof a.U?null:c,d);return b}function e(a,d){if(b.wait){if(f.Qb()||h)return f.Dh(function(){return Promise.resolve(void 0)})}else return f.add(a,d)}var f=this;b=b||{};var h=this.Pj(b),k=this.NK(c,b,!1),g=b.success,m=b.context;b.context=this;b.success=function(a,
d,c){c.xhr&&(b.xhr=c.xhr);b.wait&&f.add(k,b);g&&g.call(null!=m?m:f,a,d,b)};if(null==k)return!1;b.forceNew=null!=k.Gk();var p=a.U.AQ(b);k.sH(this);if(h||this.Qb())return new Promise(function(a){p.merge=!0;p.deferred=!0;e(k,p).then(function(){b.success=function(d,c,e){e.xhr&&(b.xhr=e.xhr);b.wait?(f.Qb()&&(p.force=!0),f.add(k,p).then(function(){g&&g.call(null!=m?m:f,d,c,b);a(d)})):(g&&g.call(null!=m?m:f,d,c,b),a(d))};var c=d(k,b);c||a(c)})});p.merge=!0;e(k,p);return d(k,b)};a.f.j("Collection.prototype.create",
{create:a.t.prototype.create});a.t.prototype.Pya=function(a){var b=[],d;this.$j("pluck");for(d=0;d<this.Hg();d+=1)b.push(this.at(d).get(a));return b};a.f.j("Collection.prototype.pluck",{Pya:a.t.prototype.Pya});a.t.prototype.oAa=function(a,b){return this.YJ(this.bM(a,b))};a.f.j("Collection.prototype.where",{oAa:a.t.prototype.oAa});a.t.prototype.bM=function(c,b){b=b||{};var d=this.Pj(b),e=this;if(this.Qb())return new Promise(function(d,f){e.TLa({query:c,all:!0,success:function(a,b){d(b)},error:function(d,
c,h){f(a.t.YI(d,c,h,e,b,!0))}})});var f=[],h,k;for(h=0;h<this.Hg();h+=1)k=this.at(h),k.HAa(c)&&f.push(k);return d?new Promise(function(a){a(f)}):f};a.t.prototype.pAa=function(c,b){b=b||{};var d=this.Pj(b),e=this;if(this.Qb()||d)return e.Dh(function(){return new Promise(function(a,d){return e.bM(c,b).then(function(b){b=e.Loa(b);a(b)},function(a){d(a)})})});d=this.bM(c,b);d=this.Loa(d);d[a.t.$g]=-1;d.Tr();return d};a.f.j("Collection.prototype.whereToCollection",{pAa:a.t.prototype.pAa});a.t.prototype.Loa=
function(a){var b=this.Eha(!1);b.TA(a,!1);b.nL();b.Tr();return b};a.t.prototype.$j=function(a){if(this.Qb())throw Error(a+" not valid on a virtual Collection");};a.t.prototype.map=function(a,b){var d=[],e;this.$j("map");this.Ze().forEach(function(f){e=a.call(b||this,f);d.push(e)});return d};a.f.j("Collection.prototype.map",{map:a.t.prototype.map});a.t.prototype.each=function(a,b){this.$j("each");this.Ze().forEach(a,b)};a.f.j("Collection.prototype.each",{each:a.t.prototype.each});a.t.prototype.size=
function(){return this.Hg()};a.f.j("Collection.prototype.size",{size:a.t.prototype.size});a.t.prototype.Rza=function(c,b){var d=[],e;this.$j("sortBy");this.Ze().forEach(function(a){d.push(a)});e=this;d.sort(function(d,h){var k,l;if(g.isFunction(c))return k=c.call(b||e,d),l=c.call(b||e,h),a.t.Lt(k,l,e.sortDirection);k=d.get(c);l=h.get(c);return a.t.Lt(k,l,e.sortDirection)});return d};a.f.j("Collection.prototype.sortBy",{Rza:a.t.prototype.Rza});a.t.prototype.Cwa=function(a,b){var d={},e;this.$j("groupBy");
this.Ze().forEach(function(f){e=g.isFunction(a)?a.call(b||this,f):f.get(a);void 0===d[e]&&(d[e]=[]);d[e].push(f)},this);return d};a.f.j("Collection.prototype.groupBy",{Cwa:a.t.prototype.Cwa});a.t.prototype.hxa=function(a,b){var d={},e;this.$j("indexBy");this.Ze().forEach(function(f){e=g.isFunction(a)?a.call(b||this,f):f.get(a);d[e]=f},this);return d};a.f.j("Collection.prototype.indexBy",{hxa:a.t.prototype.hxa});a.t.prototype.min=function(a,b){var d={},e,f;this.$j("min");if(0==this.Rf())return null;
d=this.Cd(0);e=a.call(b||this,this.Cd(0));this.Ze().forEach(function(h,k){1<=k&&(f=a.call(b||this,h),f<e&&(d=h,e=f))},this);return d};a.f.j("Collection.prototype.min",{min:a.t.prototype.min});a.t.prototype.max=function(a,b){var d={},e,f;this.$j("max");if(0==this.Rf())return null;d=this.Cd(0);e=a.call(b,this.Cd(0));this.Ze().forEach(function(h,k){1<=k&&(f=a.call(b||this,h),f>e&&(d=h,e=f))},this);return d};a.f.j("Collection.prototype.max",{max:a.t.prototype.max});a.t.prototype.filter=function(a,b){var d=
[];this.$j("filter");this.Ze().forEach(function(e){a.call(b||this,e)&&d.push(e)});return d};a.f.j("Collection.prototype.filter",{filter:a.t.prototype.filter});a.t.prototype.qAa=function(a){var b=[],d,e,f,h;this.$j("without");for(var k,g=0;g<this.Ze().length;g++){h=!0;k=this.Cd(g);for(d=0;d<arguments.length;d+=1)if(f=arguments[d].Qy(),e=arguments[d].Gk(),k.Yy(e,f)){h=!1;break}h&&b.push(k)}return b};a.f.j("Collection.prototype.without",{qAa:a.t.prototype.qAa});a.t.prototype.Pua=function(a){var b=[],
d,e,f,h,k;this.$j("difference");for(var g,m=0;m<this.Ze().length;m++){k=!0;g=this.Cd(m);for(d=0;d<arguments.length;d+=1){for(e=0;e<arguments[d].length;e++)if(h=arguments[d][e].Qy(),f=arguments[d][e].Gk(),g.Yy(f,h)){k=!1;break}if(!k)break}k&&b.push(g)}return b};a.f.j("Collection.prototype.difference",{Pua:a.t.prototype.Pua});a.t.prototype.Bi=function(){return 0===this.Hg()};a.f.j("Collection.prototype.isEmpty",{Bi:a.t.prototype.Bi});a.t.prototype.Vta=function(a,b){this.$j("any");for(var d,e=0;e<this.Rf();e+=
1)if(d=this.Cd(e),a.call(b||this,d))return!0;return!1};a.f.j("Collection.prototype.any",{Vta:a.t.prototype.Vta});a.t.prototype.eva=function(a,b){var d=this.Pj(b),e=this;if(this.Qb()||d)return this.Dh(function(){return new Promise(function(d){e.bM(a,b).then(function(a){a&&0<a.length&&d(a[0]);d(null)})})});d=this.bM(a,b);return 0<d.length?d[0]:null};a.f.j("Collection.prototype.findWhere",{eva:a.t.prototype.eva});a.t.prototype.slice=function(a,b,d){var e=this.Pj(d);d=[];if(void 0===b){if(this.Qb()&&
!this.Kw())throw Error("End must be set for virtual collections with no totalResults");b=this.Rf()}if(e||this.Qb()){var f=this;return this.Dh(function(){return f.zC(a,b)})}for(e=a;e<b;e+=1)d.push(this.Cd(e));return d};a.f.j("Collection.prototype.slice",{slice:a.t.prototype.slice});a.t.prototype.set=function(a,b){return this.R6(a,!0,b,this.Pj(b)||this.Qb())};a.f.j("Collection.prototype.set",{set:a.t.prototype.set});a.t.qqa=function(a,b,d,e,f){if(d)for(d=b.length-1;0<=d;d-=1)-1==e.indexOf(d)&&a.OA(b[d],
d,f)};a.t.prototype.TYa=function(a,b,d,e){if(this.r4()||!d||!e)return{index:a,Naa:!1};d=this.Rf();if(a>=d||b>=d)return{index:a,Naa:!1};d=this.Cd(a);e=this.Cd(b);this.iU(a,e);e.tH(a);this.iU(b,d);d.tH(b);return{index:b,Naa:b!==a}};a.t.prototype.R6=function(c,b,d,e){d=d||{};var f=void 0===d.add?!0:d.add,h=void 0===d.remove?!0:d.remove,k=void 0===d.merge?!0:d.merge,g=[],m=null,p;b&&(c=this.parse(c));p=Array.isArray(c)?c:[c];if(e){var t=this;return this.Dh(function(){return t.JKa(p,t.Ze(),d,h,f,k)})}b=
!1;for(c=0;c<p.length;c+=1)if(m=this.Dta(this.NK(p[c],d,!0),f,k,e),-1!==m){var m=this.TYa(m,c,h,f),s=m.index;m.Naa&&(b=!0);-1===g.indexOf(s)&&g.push(s)}b&&this.vd(d.silent,a.xa.ga.SORT,this,d.add?{add:!0}:null,null);a.t.qqa(this,this.Ze(),h,g,d)};a.t.prototype.JKa=function(c,b,d,e,f,h){var k=[],g,m=this;return new Promise(function(p,t){function s(a){return new Promise(function(b,e){m.Dta(m.NK(c[a],d,!0),f,h,!0).then(function(d){-1!==d&&k.push(d);b(a+1)},e)})}var n=Promise.resolve(0);for(g=0;g<c.length;g+=
1)n=n.then(s);n.then(function(){a.t.qqa(m,b,e,k,d);p(void 0)},t)})};a.t.prototype.Dta=function(a,b,d,e){function f(e,f,h){var k=f?f.index:-1;if(f&&f.m){if(d){var g={merge:d};if(h)return new Promise(function(b){e.jr(a,g,!1,!0).then(function(){b(k)})});e.add(a,g)}}else if(b){if(h)return new Promise(function(b){e.jr(a,g,!1,!0).then(function(){b(e.Hg()-1)})});e.add(a);k=e.Hg()-1}return k}if(e||this.Qb()){var h=this;return new Promise(function(b){h.gn(a,{silent:!0},e).then(function(a){f(h,a,!0).then(function(a){b(a)})})})}var k=
this.gn(a);return f(this,k,!1)};a.t.prototype.toJSON=function(){var a=[];this.$j("toJSON");this.Ze().forEach(function(b){a.push(b.toJSON())});return a};a.f.j("Collection.prototype.toJSON",{toJSON:a.t.prototype.toJSON});a.t.prototype.first=function(a,b){var d=this.Pj(b),e=this.Hg(),f=[];a?e=a:a=1;d=this.Qb()||d;if(1===a){if(d){var h=this;return this.Dh(function(){return h.v1(0,null)})}return 0<this.Rf()?this.Cd(0):null}e>this.Rf()&&(!this.Qb()||this.Kw())&&(e=this.Rf());if(d)return h=this,this.Dh(function(){return h.zC(0,
e)});for(d=0;d<e;d+=1)f.push(this.Cd(d));return f};a.f.j("Collection.prototype.first",{first:a.t.prototype.first});a.t.prototype.indexOf=function(a,b){var d=this.Pj(b);if(this.Qb()||d){var e=this;return this.Dh(function(){return e.gn(a,null,!0).then(function(a){return a.index})})}return this.gn(a).index};a.f.j("Collection.prototype.indexOf",{indexOf:a.t.prototype.indexOf});a.t.prototype.contains=function(a,b){var d=this.Pj(b);if(this.Qb()||d){var e=this;return this.Dh(function(){return e.gn(a,null,
!0).then(function(a){return-1<a.index})})}return-1<this.gn(a).index};a.f.j("Collection.prototype.contains",{contains:a.t.prototype.contains});a.t.prototype.gxa=a.t.prototype.contains;a.f.j("Collection.prototype.include",{gxa:a.t.prototype.gxa});a.t.prototype.oTa=function(a){a=this.dla(a);return void 0!==a?a.index:-1};a.t.prototype.pop=function(a){var b=this.Pj(a);if(this.Qb()||b){var d=this;return this.at(this.Hg()-1,{deferred:b}).then(function(b){d.remove(b,a);return b})}b=this.at(this.Hg()-1);this.remove(b,
a);return b};a.f.j("Collection.prototype.pop",{pop:a.t.prototype.pop});a.t.prototype.push=function(a,b){var d=this.Pj(b);this.xA(1);return this.YJ(this.jr(a,b,!1,d))};a.f.j("Collection.prototype.push",{push:a.t.prototype.push});a.t.prototype.lastIndexOf=function(c,b){var d;this.$j("lastIndexOf");void 0===b&&(b=0);for(d=this.Hg()-1;d>=b;d-=1)if(a.f.mI(c,this.at(d)))return d;return-1};a.f.j("Collection.prototype.lastIndexOf",{lastIndexOf:a.t.prototype.lastIndexOf});a.t.prototype.Pla=function(a){return void 0===
a?[]:a.split(",")};a.t.gOa=function(c){c=Array.isArray(c)?c:[c];var b="",d,e,f,h;for(f=0;f<c.length;f++){d=c[f];for(h in d)if(d.hasOwnProperty(h))for(var k=Array.isArray(d[h])?d[h]:[d[h]],l=0;l<k.length;l++){if(a.U.Yba(k[l])){e=k[l].value;var m=null,m=k[l].comparator,m=g.isFunction(m)?m(null,h,e):m;e=h+m+e}else e=h+"\x3d"+d[h];b+=e+"+"}b=b.substring(0,b.length-1)+","}return","===b.substring(b.length-1)?b.substring(0,b.length-1):b};a.t.prototype.vBa=function(c){var b={},d;for(d in c)c.hasOwnProperty(d)&&
(b[d]=c[d]);if((c=this.comparator)&&a.Wa.Hd(c)){c=this.Pla(c);for(d=0;d<c.length;d++)b.sort=0===d?c[d]:b.sort+(","+c[d]);b.sortDir=this.Rla()}this.Qb()&&(b[a.t.$g]=this.Ip(b));return b};a.t.prototype.eBa=function(){if(g.isFunction(this.customURL))return!0;var c=this.Gba(null);return a.t.St(c)};a.t.prototype.Gba=function(c){var b=a.U.Dv(this,"url");if(this.Qb()){c=c||{};var d=c.all,e=null;e=d?(e=this.totalResults)?e:this.Ip(c):this.Ip(c);b=b&&-1<b.indexOf("?")?b+"\x26":b+"?";b+="limit\x3d"+e;d||(a.t.St(c.startIndex)&&
(b+="\x26offset\x3d"+c.startIndex),c.startID&&(b+="\x26fromID\x3d"+c.startID),c.since&&(b+="\x26since\x3d"+c.since),c.until&&(b+="\x26until\x3d"+c.until));c.query&&(c=a.t.gOa(c.query))&&0<c.length&&(b+="\x26q\x3d"+c);if((c=this.comparator)&&a.Wa.Hd(c))for(c=this.Pla(c),d=this.Rla(),e=0;e<c.length;e++)b=0===e?b+("\x26orderBy\x3d"+c[e]+":"+d):b+(","+c[e]+":"+d);b+="\x26totalResults\x3dtrue"}return b};a.t.prototype.Rla=function(){return-1===this.sortDirection?"desc":"asc"};a.t.prototype.uv=function(c,
b,d){return a.sync(c,b,d)};a.f.j("Collection.prototype.sync",{uv:a.t.prototype.uv});a.t.$g="fetchSize"});