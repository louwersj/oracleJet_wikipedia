/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojeditablevalue","ojs/ojvalidation-number","ojs/ojbutton"],function(a,g){(function(){a.hb("oj.ojInputNumber",g.oj.editableValue,{version:"1.0.0",defaultElement:"\x3cinput\x3e",widgetEventPrefix:"oj",options:{converter:a.Na.bl(a.Yh.CONVERTER_TYPE_NUMBER).createConverter(),max:null,min:null,placeholder:void 0,rawValue:void 0,readOnly:!1,required:!1,step:1,autocomplete:void 0,autofocus:!1,name:void 0,validators:void 0,value:null},getNodeBySubId:function(a){var b=this._superApply(arguments),
d;b||(d=a.subId,"oj-inputnumber-up"===d&&(b=this.widget().find(".oj-inputnumber-up")[0]),"oj-inputnumber-down"===d&&(b=this.widget().find(".oj-inputnumber-down")[0]),"oj-inputnumber-input"===d&&(b=this.widget().find(".oj-inputnumber-input")[0]));return b||null},getSubIdByNode:function(a){var b=null;null!=a&&(a===this.widget().find(".oj-inputnumber-up")[0]?b={subId:"oj-inputnumber-up"}:a===this.widget().find(".oj-inputnumber-down")[0]?b={subId:"oj-inputnumber-down"}:a===this.widget().find(".oj-inputnumber-input")[0]&&
(b={subId:"oj-inputnumber-input"}));return b||this._superApply(arguments)},refresh:function(){this._super();this.qb()},stepDown:function(a){this.Lsa(a,!1)},stepUp:function(a){this.Lsa(a,!0)},widget:function(){return this.Zo},Ah:function(c,b){var d=this.options,e=this;this._superApply(arguments);this.Y()||a.ia.xs([{Aa:"disabled",jf:!0},{Aa:"placeholder"},{Aa:"value"},{Aa:"readonly",option:"readOnly",jf:!0},{Aa:"required",ek:!0,jf:!0},{Aa:"title"},{Aa:"min"},{Aa:"max"},{Aa:"step"}],b,this,function(a){for(var b=
["value","step","min","max"],c=0;c<b.length;c++){var f=b[c],g=f in a?a[f]:d[f];null!=g&&(a[f]="step"===f?e.GE(g):e.Pr(f,g))}});if(this.Y()){var f=d.step;null!=f&&e.GE(f)}if(void 0===d.value)throw Error("ojInputNumber has no value");this.Z9=d.value;if(null!=d.min&&null!=d.max&&d.max<d.min)throw Error("ojInputNumber's max must not be less than min");},qc:function(){this._super();this.gJ();this.Fna={};this.qb();this._on(this.Ut);this._focusable(this.Zo)},kt:function(c,b,d){this._superApply(arguments);
switch(c){case "min":case "max":this.hr(c,this.options[c]);break;case "readOnly":this.QC(c,a.ia.DN);break;case "required":this.yg(c);break;case "validators":this.Ti(c);break;case "converter":this.lt(c)}},Uq:function(){return this._super()?this.options.readOnly?!1:!0:!1},bZ:function(a,b){this._superApply(arguments);var d=b?b._context:null,e,f;d&&(e=d.originalEvent?!0:!1,f=d.Pu||!1);e||f||(this.Z9=this.options.value)},Vi:function(){return this.options.required},yg:a.ia.yg,Ti:a.ia.Ti,lt:a.ia.lt,tz:a.ia.tz,
yc:function(){return this.options.converter?this.UMa():g.oj.ojInputNumber.prototype.options.converter},Xq:a.ia.Xq,ez:function(){return!1},_setOption:function(a,b,d){var e;e=this.Y()||"value"!==a&&"max"!==a&&"min"!==a?"step"===a?this.GE(b):b:this.Pr(a,b);this._super(a,e,d);if("max"===a||"min"===a)this.lia(),this.Ti();"disabled"===a&&this.element.prop("disabled",!!b);"readOnly"===a&&(this.element.prop("readonly",!!b),this.DT("readOnly",this.options.readOnly),this.dqa("readOnly",this.options.readOnly))},
_destroy:function(){var c=this._super();this.cV.ojButtonset("destroy");this.cV.remove();this.Z9=this.cV=this.qM=this.ON=null;a.T.unwrap(this.element,this.Zo);clearTimeout(this.Oaa);return c},validate:a.ia.validate,hr:function(a,b,d){var e;this._superApply(arguments);switch(a){case "disabled":case "max":case "min":case "value":e=this.BJ(),this.HU(e);case "max":case "min":case "value":this.CT(e);break;case "converter":e=this.BJ();this.$pa(e);break;case "required":this.Ge(b)}},Ge:a.ia.Ge,OH:function(){var a=
this._superApply(arguments);null==this.options.min&&null==this.options.max||this.lia();return g.extend(this.Fna,a)},_GetDefaultStyleClass:function(){return"oj-inputnumber"},Ut:{input:function(a){this.Ym(this.element.val(),a)},keydown:function(a){a.keyCode===g.ui.keyCode.ENTER?(this.Jga(a),a.preventDefault()):this.Zl()&&this.Ww(a)&&a.preventDefault()},keyup:function(a){this.WA(a)},blur:function(a){this.Jga(a)},"touchstart .oj-inputnumber-button.oj-enabled":function(a){this.Zl();this.PE(null,g(a.currentTarget).hasClass("oj-inputnumber-up")?
1:-1,a)},"touchend .oj-inputnumber-button":function(a){this.WA(a)},"touchcancel .oj-inputnumber-button":function(a){this.WA(a)},"mousedown .oj-inputnumber-button.oj-enabled":function(a){this.rA(a)&&(this.Zl(),this.PE(null,g(a.currentTarget).hasClass("oj-inputnumber-up")?1:-1,a))},"mouseup .oj-inputnumber-button":function(a){this.rA(a)&&this.WA(a)},"mouseenter .oj-inputnumber-button.oj-enabled":function(a){g(a.currentTarget).hasClass("oj-active")&&this.rA(a)&&(this.Zl(),this.PE(null,g(a.currentTarget).hasClass("oj-inputnumber-up")?
1:-1,a))},"mouseleave .oj-inputnumber-button":function(a){this.rA(a)&&this.WA(a)}},cb:{VFa:"tooltipDecrement",WFa:"tooltipIncrement"},Vv:{readOnly:"oj-read-only"},qb:function(){var a=this.R(this.cb.WFa),b=this.R(this.cb.VFa),d=this.BJ();this.ON.ojButton({label:a});this.qM.ojButton({label:b});this.CT(d);this.HU(d);"boolean"===typeof this.options.readOnly&&this.element.prop("readonly",this.options.readOnly);this.DT("readOnly",this.options.readOnly);this.dqa("readOnly",this.options.readOnly);this.Ge(this.options.required)},
tTa:function(){this.ON.attr("data-oj-internal","");this.qM.attr("data-oj-internal","");this.cV.attr("data-oj-internal","")},bKa:function(){var a=this.Zo.find(".oj-inputnumber-up"),b=this.Zo.find(".oj-inputnumber-down"),d=a[0].parentNode;this.ON=a.ojButton({display:"icons",icons:{start:"oj-component-icon oj-inputnumber-up-icon"}});this.qM=b.ojButton({display:"icons",icons:{start:"oj-component-icon oj-inputnumber-down-icon"}});this.cV=g(d).ojButtonset({focusManagement:"none"});this.tTa()},gJ:function(){var c=
this.element,b;this.Zo=c.addClass("oj-inputnumber-input").wrap("\x3cspan class\x3d'oj-inputnumber-wrapper'\x3e\x3c/span\x3e").parent().append("\x3cdiv class\x3d'oj-buttonset-width-auto'\x3e\x3cbutton type\x3d'button' class\x3d'oj-inputnumber-button oj-inputnumber-down'\x3e\x3c/button\x3e\x3cbutton type\x3d'button' class\x3d'oj-inputnumber-button oj-inputnumber-up'\x3e\x3c/button\x3e\x3c/div\x3e");this.Fc?(this.Zo=g(this.Fc).append(this.Zo),this.Zo.addClass("oj-inputnumber oj-component")):this.Zo=
this.Zo.wrap("\x3cdiv class\x3d'oj-inputnumber oj-component'\x3e\x3c/div\x3e").parent();this.Y()&&(b=this.widget().attr("id"))&&a.ia.Daa(this.ze()[0],b);this.saveType=c.prop("type");c.attr("type","text");this.Zo.find(".oj-inputnumber-button").attr("tabIndex","-1");this.bKa()},Ww:function(a){var b=g.ui.keyCode;switch(a.keyCode){case b.UP:return this.PE(null,1,a),!0;case b.DOWN:return this.PE(null,-1,a),!0}return!1},s8a:function(){return"\x3cspan class\x3d'oj-inputnumber-wrapper'\x3e\x3c/span\x3e"},
u7a:function(){return"\x3cdiv class\x3d'oj-buttonset-width-auto'\x3e\x3cbutton type\x3d'button' class\x3d'oj-inputnumber-button oj-inputnumber-down'\x3e\x3c/button\x3e\x3cbutton type\x3d'button' class\x3d'oj-inputnumber-button oj-inputnumber-up'\x3e\x3c/button\x3e\x3c/div\x3e"},Zl:function(){return this.Uza=!0},PE:function(a,b,d){var e=!1;0<b?this.ON.hasClass("oj-disabled")&&(e=!0):this.qM.hasClass("oj-disabled")&&(e=!0);a=a||500;clearTimeout(this.Oaa);this.Oaa=this._delay(function(){e||this.PE(40,
b,d)},a);this.q7(b*this.options.step,d)},q7:function(a,b){var d=this.BJ(),e=this.options,f=e.min,g=e.max,e=e.step,k=this.Z9,l=this.DUa(f,e,k),d=this.kga(d,a,f,g,e,l,k);this.Uq()&&(this.element.val(d),this.CT(d),this.HU(d),this.Ym(d,b));this.ic(d,b,{validationMode:this.iI.qCa})},DUa:function(a,b,d){b=this.O5(b);null!=a&&(b=Math.max(b,this.O5(a)));null!=d&&(b=Math.max(b,this.O5(d)));return b},O5:function(a){a=a.toString();var b=a.indexOf(".");return-1===b?0:a.length-b-1},kga:function(c,b,d,e,f,g,k){var l;
if(0<g)return g=this.oHa(c,b,d,e,f,g,k);k=null!=d?d:k;null==k&&(k=0);try{c=parseFloat(c.toFixed(g))}catch(m){m instanceof TypeError&&(a.D.warn("inputNumber's value after conversion is not a number. \n\r\n                      The converter must convert the value to a Number. coercing using +"),c=+c)}l=c-k;var p=Math.round(l/f)*f,p=parseFloat(p.toFixed(g));p!==l?(l=0>b?Math.ceil(l/f)*f:Math.floor(l/f)*f,c=k+l+b):c+=b;c=parseFloat(c.toFixed(g));return null!=d&&c<d?d:null!=e&&c>e?(d=Math.floor((e-k)/
f)*f+k,d=parseFloat(d.toFixed(g))):c},oHa:function(c,b,d,e,f,g,k){a.C.assert(0<g);g=Math.pow(10,g);return this.kga(c*g,b*g,null!=d?d*g:d,null!=e?e*g:e,null!=f?f*g:f,0,k*g)/g},WA:function(){this.Uza&&(clearTimeout(this.Oaa),this.Uza=!1)},rA:function(){return!a.T.iX()},HU:function(a){var b=this.options,d=b.max,e=b.min,f=this.qM,g=this.ON,k,l,m=null!=d,p=null!=e;this.Zo&&(f||g)&&(k=f.hasClass("oj-disabled"),l=g.hasClass("oj-disabled"),b.disabled||void 0===a||m&&p&&d===e&&a===d?(k||f.ojButton("disable"),
l||g.ojButton("disable")):m&&a>=d?(k&&f.ojButton("enable"),l||g.ojButton("disable")):(p&&a<=e?k||f.ojButton("disable"):k&&f.ojButton("enable"),l&&g.ojButton("enable")))},UMa:a.ia.yc,BJ:function(){var a,b;try{b=this.Ui()||0,a=this.uT(b)}catch(d){a=void 0}return a},Jga:function(a){var b=this.element.val(),d;this.WA();d=this.BJ();this.CT(d);this.HU(d);this.ic(b,a)},lia:function(){var c=this.options,b=c.min,d=c.max,e=(c=c.translations)?c.numberRange||{}:{},f,g,k,l,m,p,t,s,n,c=e.hint||{},q=e.messageDetail||
{},e=e.messageSummary||{};null!==c&&(f=c.min||null,g=c.max||null,k=c.inRange||null,l=c.exact||null);null!==q&&(m=q.rangeOverflow||null,p=q.rangeUnderflow||null,t=q.exact||null);null!==e&&(s=e.rangeOverflow||null,n=e.rangeUnderflow||null);b={min:null!=b?b:void 0,max:null!=d?d:void 0,hint:{min:f||null,max:g||null,inRange:k||null,exact:l||null},messageDetail:{rangeOverflow:m||null,rangeUnderflow:p||null,exact:t||null},messageSummary:{rangeOverflow:s||null,rangeUnderflow:n||null},converter:this.yc()};
this.Fna[a.cg.VALIDATOR_TYPE_NUMBERRANGE]=a.Na.hC(a.cg.VALIDATOR_TYPE_NUMBERRANGE).createValidator(b)},Pr:function(a,b){var d;d=null!==b?+b:b;if(isNaN(d))throw Error("ojInputNumber's "+a+" option is not a number");return d},GE:function(a){if(null===a)return 1;a=this.Pr("step",a);if(0>=a)throw Error("Invalid step for ojInputNumber; step must be \x3e 0");if(null===a||0>=a)a=1;return a},DT:function(a,b){-1!=Object.keys(this.Vv).indexOf(a)&&this.widget().toggleClass(this.Vv[a],!!b)},dqa:function(a,b){b?
this.element.removeAttr("role"):this.element.attr("role","spinbutton")},CT:function(a){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":a});this.$pa(a)},$pa:function(a){var b=this.element,d=b.val();this.Dl("value",""+a,d)||b.attr({"aria-valuetext":d})},Lsa:function(a,b){this.Zl();b?this.q7((a||1)*this.options.step):this.q7((a||1)*-this.options.step);this.WA()},bo:a.ia.bo})})();a.J.Ua("oj-input-number","editableValue",{properties:{autocomplete:{type:"string",
enumValues:["off","on"],extension:{Aj:!0}},autofocus:{type:"boolean",extension:{Aj:!0}},converter:{type:"Object"},max:{type:"number"},min:{type:"number"},name:{type:"string",extension:{Aj:!0}},placeholder:{type:"string"},rawValue:{type:"string",writeback:!0,readOnly:!0},readonly:{type:"boolean"},required:{type:"boolean"},step:{type:"number"},validators:{type:"Array"},value:{type:"number",writeback:!0}},methods:{stepDown:{},stepUp:{},validate:{}},extension:{jt:{readonly:"readOnly"},Dj:"input",Xa:"ojInputNumber",
XC:["accesskey","aria-label","tabindex"]}});a.J.register("oj-input-number",{metadata:a.J.getMetadata("oj-input-number")})});