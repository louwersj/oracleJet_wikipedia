/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","promise","ojs/ojcomponentcore","ojs/ojanimation"],function(a,g){(function(){var c=0;a.hb("oj.ojCollapsible",g.oj.baseComponent,{widgetEventPrefix:"oj",options:{expanded:!1,disabled:!1,expandOn:"click",expandArea:"header",beforeExpand:null,expand:null,beforeCollapse:null,collapse:null},qc:function(){this._super();this.element.addClass("oj-collapsible oj-component");this.Npa();this.kg();this.dj=!0;this.S1(this.h1(this.element[0],this.options.expanded?"ojexpand":"ojcollapse"));
this.dj=void 0},h1:function(a,c){return{type:c,target:a,currentTarget:a,preventDefault:g.noop}},Xi:function(a,c,e){this.$i(c,e,{launcher:this.yJ().first()})},TJa:function(){var a=this.options.expanded?"oj-collapsible-open-icon":"oj-collapsible-close-icon";(this.zo()?g("\x3cspan\x3e"):g("\x3ca href\x3d'#'\x3e")).addClass("oj-component-icon oj-clickable-icon-nocontext oj-collapsible-header-icon "+a).attr("aria-labelledby",this.header.attr("id")).prependTo(this.header)},Oia:function(){this.header.children(".oj-collapsible-header-icon").remove()},
_destroy:function(){this.oL();this.Ap();this.element.removeClass("oj-collapsible oj-component oj-expanded oj-collapsed oj-disabled");this.zo()&&this.a2(this.header).removeAttr("tabIndex");this.header.removeClass("oj-collapsible-header").each(function(){/^oj-collapsible/.test(this.id)&&this.removeAttribute("id")});this.pJ().removeAttr("role").removeAttr("aria-controls").removeAttr("aria-expanded").removeAttr("aria-disabled");this.Oia();this.content.css("display","").removeAttr("aria-hidden").removeAttr("tabIndex").removeClass("oj-component-content oj-collapsible-content").each(function(){/^oj-collapsible/.test(this.id)&&
this.removeAttribute("id")})},Ap:function(){this.hF();this.content&&(a.T.unwrap(this.content),this.Vs=null)},zo:function(){return this.element.hasClass("oj-disabled")},Eka:function(){return"header"==this.options.expandArea?"\x3e .oj-collapsible-header":"\x3e .oj-collapsible-header \x3e .oj-collapsible-header-icon"},yJ:function(){return this.header.find(".oj-collapsible-header-icon")},_setOption:function(a,c,e){"expanded"===a?c!==this.options.expanded&&(c?this.expand(!0):this.collapse(!0)):"disabled"===
a?(this.header.add(this.header.next()),this.element.toggleClass("oj-disabled",!!c)):"expandOn"===a||"expandArea"===a?(this.hF(),this._super(a,c,e),this.Yp()):this._super(a,c,e)},Ww:function(a){if(!a.altKey&&!a.ctrlKey){var c=g.ui.keyCode;switch(a.keyCode){case c.SPACE:case c.ENTER:this.ita(a)}}},refresh:function(){this._super();this.Ap();this.Npa();this.Oia();this.kg()},RUa:function(){var b=this.element[0],c=!1,e=a.J.Dn(b).header,f;if(e&&e.length)if(1===e.length)f=e[0];else{c=g("\x3cspan slot\x3d'header'\x3e\x3c/span\x3e");
f=c[0];for(var h=0;h<e.length;h++)f.appendChild(e[h]);c.children().attr("slot","");c=!0}else f=g("\x3cspan slot\x3d'header'\x3e\x3c/span\x3e")[0],c=!0;(c||0!==this.element.children().index(f))&&b.insertBefore(f,b.firstChild);return g(f)},PUa:function(){var b=this.element[0],c=a.J.Dn(b)[""],e;if(c&&1===c.length)e=c[0];else{e=g("\x3cdiv\x3e\x3c/div\x3e")[0];if(c&&c.length)for(var f=0;f<c.length;f++)e.appendChild(c[f]);b.appendChild(e)}return g(e)},Npa:function(){this.header=this.Y()?this.RUa():this.element.children(":first-child");
this.header.addClass("oj-collapsible-header");this.content=this.Y()?this.PUa():this.header.next();this.content.addClass("oj-collapsible-content oj-component-content");this.content.wrap("\x3cdiv\x3e\x3c/div\x3e");this.Vs=this.content.parent().addClass("oj-collapsible-wrapper");this.options.disabled&&this.element.addClass("oj-disabled");this.zo()&&this.a2(this.header).attr("tabIndex",-1)},kg:function(){var a=this.header,d=this.content,e=this.options,f="oj-collapsible-"+(this.element.attr("id")||++c),
g=a.attr("id"),k=d.attr("id");g||a.attr("id",f+"-header");k||(k=f+"-content",d.attr("id",k));this.TJa();a=this.pJ();a.attr("role","button").attr("aria-controls",k).attr("aria-expanded",e.expanded);this.zo()&&a.attr("aria-disabled","true");e.expanded?d.removeAttr("aria-hidden"):(this.Vs.css({"max-height":0,"overflow-y":"hidden",display:"none"}),d.attr("aria-hidden","true"));this.Yp()},Yp:function(){var b={keydown:this.Ww},c=this.options.expandOn;if(c){var e=this;g.each(c.split(" "),function(c,d){a.T.uW(d)&&
(b[d]=e.ita)})}c=this.element.find(this.Eka());this._on(c,b);this._on(this.Vs,{transitionend:this.mF,webkitTransitionEnd:this.mF});this.zo()||(this._on(this.element,{ojfocus:this.Rja,ojfocusout:this.Rja}),this._focusable({element:this.yJ(),applyHighlight:!0}),this.xg(c),this.Cl(c))},hF:function(){var a=this.element.find(this.Eka());this.sz(a);this.$H(a);this._off(a);this.Vs&&this._off(this.Vs);this._off(this.element.add(this.content))},ita:function(a){this.zo()||a.isDefaultPrevented()||(this.options.expanded?
this.collapse(!0,a):this.expand(!0,a),a.preventDefault(),a.stopPropagation(),this.yJ().focus())},D0:function(a){var c=a.css("transitionProperty"),e=a.css("transitionDelay");a=a.css("transitionDuration");e=e.split(",");a=a.split(",");for(var c=c.split(",").length,f=e.length,g=a.length,k=0,l=0;l<c;l++){var m=a[l%g],m=-1<m.indexOf("ms")?parseFloat(m):1E3*parseFloat(m);if(0<m)var p=e[l%f],p=-1<p.indexOf("ms")?parseFloat(p):1E3*parseFloat(p),k=Math.max(k,p+m)}return k+100},ara:function(a){var c=this;this.J7=
setTimeout(function(){c.mF()},c.D0(a))},S1:function(b){if(!(this.zo()||b.target!==this.element[0]||!this.dj&&b.isDefaultPrevented&&b.isDefaultPrevented())){var c=this.element,e=this.content,f=this.Vs,g="ojexpand"===b.type,k=this;b.preventDefault();this.dj||this.xIa(g);this.dj||document.hidden||this.element.hasClass("oj-collapsible-skip-animation")?(g||(f.css("max-height",0),f.hide()),k.lga(g,b)):(f.mM=f.outerHeight(),this.Hj||(this.Hj=a.Context.getContext(c[0]).Rc().Vc({description:"The collapsible id\x3d'"+
this.element.attr("id")+"' is animating."})),this.qta=!1,g?(f.show(),setTimeout(function(){f.mM+=e.outerHeight();f.addClass("oj-collapsible-transition").css({"max-height":f.mM});k.ara(f)},0)):(f.removeClass("oj-collapsible-transition"),f.css({"max-height":f.mM,"overflow-y":"hidden"}),0==f.mM?k.mF():setTimeout(function(){f.addClass("oj-collapsible-transition").css({"max-height":0});k.ara(f)},20)))}},Rja:function(a){if(this.zo())return null;"ojfocusout"==a.type?(this.pJ().attr("tabIndex",-1),a.preventDefault(),
a.stopPropagation()):"ojfocus"==a.type&&(this.pJ().attr("tabIndex",0).focus(),a.preventDefault(),a.stopPropagation())},pJ:function(){return this.a2(this.header).first()},a2:function(a){return this.zo()?a.find("span"):a.find("a,:input")},expand:function(a,c){if(!this.zo()){var e={header:this.header,content:this.content};a&&!1===this._trigger("beforeExpand",c,e)||this.S1(this.h1(this.element[0],"ojexpand"))}},collapse:function(a,c){if(!this.zo()){var e={header:this.header,content:this.content};a&&!1===
this._trigger("beforeCollapse",c,e)||this.S1(this.h1(this.element[0],"ojcollapse"))}},mF:function(a){if(!(this.zo()||a&&a.target!==this.element[0])){var c=!1;a&&a.originalEvent&&(c="max-height"==a.originalEvent.propertyName);c&&this.J7&&(clearTimeout(this.J7),this.J7=void 0);a&&(a.preventDefault(),a.stopImmediatePropagation());if(!this.qta){if(c||!a)this.qta=!0;this.options.expanded?this.Vs.css({"max-height":9999,"overflow-y":""}):this.Vs.hide();this.Vs.removeClass("oj-collapsible-transition");this.lga(this.options.expanded,
a)}}},oL:function(){this.Hj&&(this.Hj(),this.Hj=null)},lga:function(b,c){var e=this.element,f=this.Vs;b?(e.removeClass("oj-collapsed"),e.addClass("oj-expanded"),a.Components.Yo(f[0])):(e.removeClass("oj-expanded"),e.addClass("oj-collapsed"),a.Components.Jq(f[0]));this.yJ().toggleClass("oj-collapsible-open-icon",b).toggleClass("oj-collapsible-close-icon",!b||!1).end();b?this.content.removeAttr("aria-hidden"):this.content.attr("aria-hidden","true");this.pJ().attr("aria-expanded",b);this.oL();e={header:this.header,
content:this.content};this.dj||(b?this._trigger("expand",c,e):this._trigger("collapse",c,e))},xIa:function(a){this.option("expanded",a,{_context:{ld:!0,mb:!0}})},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;switch(a.subId){case "oj-collapsible-content":return this.content[0];case "oj-collapsible-header":return this.header[0];case "oj-collapsible-disclosure":case "oj-collapsible-header-icon":return this.yJ()[0]}return null},getSubIdByNode:function(a){for(var c=this.getNodeBySubId({subId:"oj-collapsible-disclosure"});a;){if(a===
this.content[0])return{subId:"oj-collapsible-content"};if(a===this.header[0])return{subId:"oj-collapsible-header"};if(a===c)return{subId:"oj-collapsible-disclosure"};a=a.parentElement}return null}})})();a.J.Ua("oj-collapsible","baseComponent",{properties:{disabled:{type:"boolean"},expandArea:{type:"string",enumValues:["header","disclosureIcon"]},expanded:{type:"boolean",writeback:!0}},events:{beforeCollapse:{},beforeExpand:{},collapse:{},expand:{}},extension:{Xa:"ojCollapsible"}});a.J.register("oj-collapsible",
{metadata:a.J.getMetadata("oj-collapsible")})});