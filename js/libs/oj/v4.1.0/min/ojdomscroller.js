/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery"],function(a,g){a.Zh=function(a,b,d){d=d||{};this.p=b;this.zp=d.asyncIterator;this.Sk=g(a)[0];this.cR=d.fetchSize;this.cR=0<this.cR?this.cR:25;this.yE=d.maxCount;this.yE=0<this.yE?this.yE:500;this.vu=0<d.initialRowCount?d.initialRowCount:0;this.Osa=d.success;this.Oqa=d.request;this.aR=d.error;this.LA();this.lo=d.fetchTrigger;if(null==this.lo||isNaN(this.lo))this.lo=0;this.SRa=this.Sk.scrollTop;g(this.VR()).on("scroll.domscroller",function(){var a=this.Sk,b=this.mOa(a),
a=a.scrollHeight-a.clientHeight;0<a&&this.j4(b,a)}.bind(this))};a.Zh.prototype.E5a=function(a){null!=a&&!isNaN(a)&&0<=a&&(this.lo=a)};a.Zh.prototype.VR=function(){return this.Sk==document.body||this.Sk==document.documentElement?window:this.Sk};a.Zh.S_a=function(a,b){for(var d=0,e=b;e&&e!=a&&g.contains(a,e);)d+=e.offsetTop,e=e.offsetParent;return d};a.Zh.prototype.mOa=function(a){var b=this.lo;return a==document.documentElement&&(void 0===this.Ita&&(this.Ita=this.SRa==a.scrollTop?!0:!1),this.Ita)?
b+document.body.scrollTop:b+a.scrollTop};a.Zh.prototype.destroy=function(){this.aq();g(this.VR()).off("scroll.domscroller")};a.f.j("DomScroller.prototype.destroy",{destroy:a.Zh.prototype.destroy});a.Zh.prototype.checkViewport=function(){return this.zp&&0<this.Sk.clientHeight&&!this.BIa()?this.Cja():Promise.resolve(null)};a.f.j("DomScroller.prototype.checkViewport",{checkViewport:a.Zh.prototype.checkViewport});a.Zh.prototype.j4=function(a,b){if(1>=b-a&&a>this.lo&&!this.nJ)if(this.zp){var d=this;this.Cja().then(function(a){d.Osa&&
d.Osa(a)},function(a){d.aR&&d.aR(a)})}else null!=this.aR&&this.aR()};a.Zh.prototype.BIa=function(){var a=this.Sk;return a.scrollHeight>a.clientHeight+this.lo?!0:!1};a.Zh.prototype.Cja=function(){if(this.nJ)return this.nJ;var a=this.yE-this.vu;if(0<a){var b=this;if(this.zp)return null!=this.Oqa&&this.Oqa(),this.nJ=this.zp.next().then(function(d){b.nJ=null;null!=d&&null!=d.value&&(0<d.value.data.length&&(b.vu+=d.value.data.length,a<b.cR&&(d.maxCount=b.yE,d.maxCountLimit=!0,d.value.data.length>a&&(d.value.data=
d.value.data.slice(0,a),d.value.metadata=d.value.metadata.slice(0,a),null!=d.value.fetchParameters&&(d.value.fetchParameters.size=a)))),d.done&&(b.zp=null));return Promise.resolve(d)})}return Promise.resolve({maxCount:this.yE,maxCountLimit:!0})};a.Zh.prototype.qPa=function(a){var b=null,d=null;null!=a.detail.remove&&(b="remove",d=a.detail.remove);null!=a.detail.add&&(b="add",d=a.detail.add);if(null!=b){a=d.indexes;for(var e=a.length,d=0;d<e;d++){var f=a[d];void 0!==f&&0<this.vu&&f<=this.vu&&("add"==
b?this.vu+=1:"remove"==b&&(this.vu-=1))}}};a.Zh.prototype.LA=function(){var a=this.p;if(null!=a){this.aq();this.eh=[];this.eh.push({eventType:"mutate",eventHandler:this.qPa.bind(this)});var b,d;for(b=0;b<this.eh.length;b++)(d=a.addEventListener(this.eh[b].eventType,this.eh[b].eventHandler))&&(this.eh[b].eventHandler=d)}};a.Zh.prototype.aq=function(){var a=this.p;if(null!=this.eh&&null!=a){var b;for(b=0;b<this.eh.length;b++)a.removeEventListener(this.eh[b].eventType,this.eh[b].eventHandler)}}});