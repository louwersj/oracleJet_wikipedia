/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","promise","ojs/ojcustomelement","ojs/ojcomposite-knockout"],function(a){a.ac={};a.ac.Zf=Object.create(a.aa.Zf);a.oc.Ed(a.ac.Zf,{SN:function(b){b.setProperty=function(b,c){var f=a.$b.zn(b),g=a.aa.Ya(this),k=a.aa.Zm(b,a.aa.hl(g));f||!k?this[b]=c:(f=this.getProperty(b),g.TO(g.Zs.bind(g),this,b,c,this),g.YH&&-1!==b.indexOf(".")&&a.ac.QD(this,b,c,f,"external"))};b.getProperty=function(b){var c=a.$b.zn(b),f=a.aa.Ya(this),f=a.aa.Zm(b,a.aa.hl(f));return c||!f||-1===b.indexOf(".")?this[b]:
a.aa.I_(this,b)};b._propsProto.setProperty=function(b,c){if(a.aa.Zm(b,a.aa.hl(this.mt))){var f=this.getProperty(b);this.mt.TO(this.mt.Zs.bind(this.mt),this,b,c,this.gz);-1!==b.indexOf(".")&&a.ac.QD(this.gz,b,c,f,"internal")}else this.gz[b]=c};b._propsProto.getProperty=function(b){return a.aa.Zm(b,a.aa.hl(this.mt))&&-1!==b.indexOf(".")?a.aa.I_(this,b):this[b]};b.getNodeBySubId=function(b){var c=a.aa.Ya(this);return c.xz.getNodeBySubId?c.xz.getNodeBySubId(b,c.tla.bind(this)):c.tla.bind(this)(b)};b.getSubIdByNode=
function(b){var c=a.aa.Ya(this);return c.xz.getSubIdByNode?c.xz.getSubIdByNode(b,c.Sla.bind(this)):c.Sla.bind(this)(b)}},XN:function(b){if(this.nz){var c=this;this.wCa=this.nz.then(function(b){return a.vh.eG(b,"activatedMethod",[c.PP])})}this.c_.FG(this.gg);var e={},f=a.vh.r0a(b),g;for(g in f)e[g]=f[g].length;this.DFa=f;this.Xea.FG(e);c=this;Promise.all([this.Bfa,this.nz,this.c_.mq(),this.TCa,this.wCa]).then(function(f){f=f[0];if(!f)throw this.rj(),"ojComposite is missing a View";var g={props:c.gg,
V5a:c.DFa,W5a:e,unique:c.PP.unique,uniqueId:c.PP.uniqueId,Dy:c.xz,nAa:c.PP};Object.defineProperty(b,a.lf.Cfa,{value:"knockout"});a.vh.f5a(g,b,f);c.YH=!0;c.rj();a.ac.Uz("ready",b)})},aY:function(b,c,e){b[c]=function(){var b=e.internalName||c,g=a.aa.Ya(this);return g.xz[b].apply(g.xz,arguments)}},ZN:function(b,c,e){function f(b){var f=a.ac.Fla(this.mt,c);b=b?f.peek():f();void 0===b&&(b=e.value,"object"===typeof b?b=a.oc.Ed({},b,void 0,!0):Array.isArray(b)&&(b=b.slice()),f(b));return b}function g(a){k.bind(this)(a,
!1)}function k(b,f){var g=a.ac.Fla(this.mt,c),h=g.peek();h!==b&&(f&&(b=this.mt.NC(this.gz,c,b)),g(b),e.lJ&&(g=a.$b.zn(c),h&&this.gz.removeEventListener(g,h),b&&(b instanceof Function?this.gz.addEventListener(g,b):a.aa.kD(this,c,b,"function"))),!e.JQ&&(!f||f&&this.mt.YH)&&a.ac.QD(this.gz,c,b,h,f?"external":"internal"))}e.JQ||a.ac.Eia(b._propsProto,c,function(){return f.bind(this,!1)()},g);a.ac.Eia(b,c,function(){var b=a.aa.Ya(this);return f.bind(b.gg,!0)()},function(b){var f=a.aa.Ya(this);if(e.readOnly)throw f.rj(),
"Read-only property "+c+" cannot be set on "+this.tagName;k.bind(f.gg)(b,!0)})},cH:function(a){return a._metadata},Sba:function(b){this.nz&&this.nz.then(function(c){a.vh.eG(c,"disposeMethod",[b])})},eH:function(b){a.aa.Zf.eH.call(this,b);this.nz&&this.nz.then(function(c){a.vh.eG(c,"detachedMethod",[b])})},Uy:function(b){a.aa.Zf.Uy.call(this,b);a.ac.Uz("pending",b);var c=a.aa.VP(b.tagName);this.CO=c.parseFunction;b._propsProto&&(this.gg=Object.create(b._propsProto),this.gg.mt=this,this.gg.gz=b);this.c_=
new a.aa.TP;this.Xea=new a.aa.TP;var e={element:b,props:this.c_.mq(),slotNodeCounts:this.Xea.mq(),unique:a.ac.DOa()};e.uniqueId=b.id?b.id:e.unique;this.PP=e;var f=a.ac.RR(c,"viewModel",this);if(f){var g=this;this.nz=f.then(function(b){b="function"===typeof b?new b(e):a.vh.eG(b,"initializeMethod",[e])||b;return g.xz=b})}var k=a.aa.fGa(b.tagName);if(k.view)this.Bfa=Promise.resolve(a.ac.B2(k.view));else if(f=a.ac.RR(c,"view",this))this.Bfa=f.then(function(b){"string"===typeof b&&(b=a.ac.B2(b));k.view=
b;return a.ac.B2(k.view)});!k.css&&(c=a.ac.RR(c,"css",this))&&(k.css=c.then(function(a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));document.head.appendChild(b)}));this.TCa=k.css;a.aa.J_(b,this.gg,this.CO);this.jO().FG()},Wba:function(a){Object.defineProperty(a,"_propsProto",{value:{}})},tla:function(b){var c=a.ac.hGa(this)[b.subId];return c?c.alias?(b=a.oc.Ed({},b,void 0,!0),b.subId=c.alias,c=c.node,c.getNodeBySubId?
c.getNodeBySubId(b):a.Components.wd(c)("getNodeBySubId",b)):c.node:null},Sla:function(b){if(!this.contains(b))return null;var c=a.ac.gGa(this),e=a.lf.wva(b,this);if(null!=e){var f=e.Kn.getAttribute("data-oj-subid-map");return(c=c[f])&&e.getSubIdByNode&&(b=e.getSubIdByNode(b))?(b.subId=c.map[b.subId],b):null}for(e=b;e!==this&&!(f=e.getAttribute("data-oj-subid-map")||e.getAttribute("data-oj-subid"));)e=e.parentNode;if(c=c[f])if(c.map){if(f=c.node,b=f.getSubIdByNode?f.getSubIdByNode(b):a.Components.wd(f)("getSubIdByNode",
b))return b.subId=c.map[b.subId],b}else return{subId:f};return null}});a.ac.register=function(b,c){a.aa.Hfa(b,c,a.ac.Zf,!0)&&a.ac.getMetadata(b).then(function(e){var f=e.name;f?b!=f&&a.D.warn("Registered property tagName: %s does not match name: %s provided in metadata.",b,f):a.D.warn('Required property "name" missing from metadata for %s.',b);e.version||a.D.warn('Required property "version" missing from metadata for %s.',b);e.jetVersion||a.D.warn('Required composite "jetVersion" missing from metadata for %s.',
b);c._metadata=a.aa.Gfa(e,!1);customElements.define(b.toLowerCase(),a.ac.Zf.vM(c))})};a.ac.getMetadata=function(b){var c=a.aa.VP(b);if(c){var e=c._metadataPromise;e||(e=a.ac.RR(c,"metadata",null),e||(a.D.warn("Required metadata is missing for "+b),e=Promise.resolve({})),c._metadataPromise=e);return e}return null};a.ac.Eia=function(a,c,e,f){Object.defineProperty(a,c,{enumerable:!0,get:e,set:f})};a.ac.Uz=function(a,c){c.dispatchEvent(new CustomEvent(a,{bubbles:!0}))};a.ac.QD=function(a,c,e,f,g){var k=
{},l=c.split("."),m=c,p=e,t=f;1<l.length&&(m={},m.path=c,m.value=e,m.previousValue=f,k.subproperty=m,m=l[0],t=p=a[m]);k.value=p;k.previousValue=t;k.updatedFrom=g;a.dispatchEvent(new CustomEvent(m+"-changed",{detail:k}));a.dispatchEvent(new CustomEvent(m+"Changed",{detail:k}))};a.ac.B2=function(b){if("string"===typeof b){var c=document.createElement("div");c.innerHTML=b;b=[];for(var e=0;e<c.childNodes.length;e++)b.push(c.childNodes[e]);return b}if(a.ac.kSa(b)){c=b.cloneNode(!0);b=[];for(e=0;e<c.childNodes.length;e++)b.push(c.childNodes[e]);
return b}if(Array.isArray(b)){c=[];for(e=0;e<b.length;e++)c.push(b[e].cloneNode(!0));return c}a.aa.Ya(this).rj();throw"The View ("+b+") has an unsupported type";};a.ac.Wja=function(b,c){if(!b.$ea){for(var e={},f={},g=c.children,k=0;k<g.length;k++)a.ac.Pta(e,f,g[k]);b.IEa=f;b.$ea=e}};a.ac.Pta=function(b,c,e){if(!e.hasAttribute("slot")&&(a.ac.ZGa(b,c,e),!a.aa.yB(e.tagName)&&!a.Components.wd(e))){e=e.children;for(var f=0;f<e.length;f++)a.ac.Pta(b,c,e[f])}};a.ac.ZGa=function(a,c,e){var f=e.getAttribute("data-oj-subid"),
g=e.getAttribute("data-oj-subid-map");if(g){if(f=JSON.parse(g),"object"===typeof f&&!(f instanceof Array)){var k={},l;for(l in f)a[l]={alias:f[l],node:e},k[f[l]]=l;c[g]={map:k,node:e}}}else f&&(a[f]={node:e},c[f]={node:e})};a.ac.hGa=function(b){var c=a.aa.Ya(b);a.ac.Wja(c,b);return c.$ea};a.ac.gGa=function(b){var c=a.aa.Ya(b);a.ac.Wja(c,b);return c.IEa};a.ac.Fla=function(b,c){b.KP||(b.KP={});b.KP[c]||(b.KP[c]=a.vh.H0a());return b.KP[c]};a.ac.RR=function(a,c,e){var f=null;a=a[c];if(null!=a)if(a.hasOwnProperty("inline"))f=
Promise.resolve(a.inline);else if(a.hasOwnProperty("promise"))f=a.promise;else throw e&&e.rj(),"Invalid descriptor key '"+Object.keys(a)[0]+"' for the resource type: "+c;return f};a.ac.DOa=function(){return c+g++};a.ac.kSa=function(a){return window.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType};var g=0,c="_ojcomposite";a.lf={};a.lf.Md={initializeMethod:"initialize",activatedMethod:"activated",attachedMethod:"attached",bindingsAppliedMethod:"bindingsApplied",detachedMethod:"detached",
disposeMethod:"dispose"};o_("Composite.defaults",a.lf.Md,a);a.lf.getMetadata=function(b){return a.ac.getMetadata(b)};o_("Composite.getMetadata",a.lf.getMetadata,a);a.lf.register=function(b,c){a.ac.register(b,c)};o_("Composite.register",a.lf.register,a);a.lf.wva=function(b,c){for(var e=null;b;)if(b=a.vh.C1a(b)){if(c&&!(b.compareDocumentPosition(c)&16))break;e=b}return e};a.lf.q1a=function(b){return b?b[a.lf.Cfa]:null};a.lf.Dfa="__oj_composite";a.lf.Cfa="__oj_binding_prvdr"});