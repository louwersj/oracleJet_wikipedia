/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojdvt-base","ojs/internal-deps/dvt/DvtDiagram","ojs/ojdatasource-common"],function(a,g,c,b,d){a.Xs=function(b,c){this.ks=c?c.childData:null;a.Xs.N.constructor.call(this,b)};a.f.va(a.Xs,a.Jy,"oj.ConversionDiagramDataSource");a.Xs.prototype.getData=function(a){if(a){var b=a.nodes;return void 0===b&&this.ks?(a=this.ks(a),Promise.resolve(a).then(function(a){return Promise.resolve({nodes:a})},function(){return Promise.resolve({nodes:[]})})):Promise.resolve({nodes:b})}return this.data?
(a=this.data.nodes,b=this.data.links,a instanceof Function&&(a=a()),b instanceof Function&&(b=b()),Promise.all([a,b]).then(function(a){return Promise.resolve({nodes:a[0],links:a[1]})},function(){return Promise.resolve({nodes:[],links:[]})})):Promise.resolve(null)};a.f.j("ConversionDiagramDataSource.prototype.getData",{getData:a.Xs.prototype.getData});a.Xs.prototype.getChildCount=function(a){return a?(a=a.nodes,Array.isArray(a)?a.length:void 0===a&&this.ks?-1:0):-1};a.f.j("ConversionDiagramDataSource.prototype.getChildCount",
{getChildCount:a.Xs.prototype.getChildCount});a.Xs.prototype.getDescendantsConnectivity=function(){return"unknown"};a.f.j("ConversionDiagramDataSource.prototype.getDescendantsConnectivity",{getDescendantsConnectivity:a.Xs.prototype.getDescendantsConnectivity});a.hb("oj.ojDiagram",g.oj.dvtBaseComponent,{widgetEventPrefix:"oj",options:{beforeExpand:null,expand:null,beforeCollapse:null,collapse:null},gr:function(){this._super();this.options._logger=a.D;this.options._templateFunction&&(this.options.renderer=
this.tZ(this.options._templateFunction,"node"));this.options.renderer&&(this.options._contextHandler=this.w2());this.options.nodes&&(this.options.nodeProperties=this.options.nodeProperties?this.options.nodeProperties:function(a){return a},this.options.linkProperties=this.options.linkProperties?this.options.linkProperties:function(a){return a},this.options.data=new a.Xs({nodes:this.options.nodes,links:this.options.links},{childData:this.options.childNodes}))},rt:function(){return"tooltip/renderer renderer focusRenderer hoverRenderer selectionRenderer zoomRenderer".split(" ")},
w2:function(){var b=this;return function(c,d,g,l,m,p){c={component:a.Components.wd(b.element),parentElement:c,rootElement:d,content:g,data:l,state:m,previousState:p,id:l.id,type:"node",label:l.label};b.Y()&&(c.renderDefaultHover=b.renderDefaultHover.bind(b,c),c.renderDefaultSelection=b.renderDefaultSelection.bind(b,c),c.renderDefaultFocus=b.renderDefaultFocus.bind(b,c));return b.Nk(c)}},renderDefaultHover:function(a){a.previousState&&a.state.hovered==a.previousState.hovered||this.NH(this.element).processDefaultHoverEffect(a.id,
a.state.hovered)},renderDefaultSelection:function(a){a.previousState&&a.state.selected==a.previousState.selected||this.NH(this.element).processDefaultSelectionEffect(a.id,a.state.selected)},renderDefaultFocus:function(a){a.previousState&&a.state.focused==a.previousState.focused||this.NH(this.element).processDefaultFocusEffect(a.id,a.state.focused)},di:function(a,b,c){return d.Diagram.newInstance(a,b,c)},Nm:function(a){var b=a.subId;"oj-diagram-link"==b?b="link["+a.index+"]":"oj-diagram-node"==b?b=
"node["+a.index+"]":"oj-diagram-tooltip"==b&&(b="tooltip");return b},Bj:function(a){var b={};0==a.indexOf("link")?(b.subId="oj-diagram-link",b.index=this.Tm(a)):0==a.indexOf("node")?(b.subId="oj-diagram-node",b.index=this.Tm(a)):"tooltip"==a&&(b.subId="oj-diagram-tooltip");return b},ah:function(){var a=this._super();a.push("oj-diagram");return a},El:function(){var a=this._super();a["oj-diagram-node-label"]={path:"styleDefaults/nodeDefaults/labelStyle",property:"CSS_TEXT_PROPERTIES"};a["oj-diagram-node oj-selected"]=
{path:"styleDefaults/nodeDefaults/selectionColor",property:"border-color"};a["oj-diagram-node oj-hover"]=[{path:"styleDefaults/nodeDefaults/hoverOuterColor",property:"border-top-color"},{path:"styleDefaults/nodeDefaults/hoverInnerColor",property:"border-bottom-color"}];a["oj-diagram-link"]={path:"styleDefaults/linkDefaults/color",property:"color"};a["oj-diagram-link-label"]={path:"styleDefaults/linkDefaults/labelStyle",property:"CSS_TEXT_PROPERTIES"};a["oj-diagram-link oj-selected"]={path:"styleDefaults/linkDefaults/selectionColor",
property:"border-color"};a["oj-diagram-link oj-hover"]=[{path:"styleDefaults/linkDefaults/hoverOuterColor",property:"border-top-color"},{path:"styleDefaults/linkDefaults/hoverInnerColor",property:"border-bottom-color"}];return a},Sm:function(){return["optionChange","beforeExpand","beforeCollapse","expand","collapse"]},Yn:function(a){var b=a.type;"beforeExpand"===b?this.expand(a.id,!0):"beforeCollapse"===b?this.collapse(a.id,!0):"expand"===b||"collapse"===b?this._trigger(b,null,{nodeId:a.id}):this._super(a)},
_setOptions:function(a,b){a.expanded&&this.Ka.clearDisclosedState();this._superApply(arguments)},Ok:function(){var a=this.options.translations,b=this._super();b["DvtDiagramBundle.PROMOTED_LINK"]=a.promotedLink;b["DvtDiagramBundle.PROMOTED_LINKS"]=a.promotedLinks;b["DvtDiagramBundle.PROMOTED_LINK_ARIA_DESC"]=a.promotedLinkAriaDesc;b["DvtUtilBundle.DIAGRAM"]=a.componentName;return b},mp:function(){null==this.options._resources&&(this.options._resources={});var b=this.options._resources;"rtl"===a.T.lj()?
(b.collapse_ena={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-ena_rtl.svg"),width:20,height:20},b.collapse_ovr={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-ovr_rtl.svg"),width:20,height:20},b.collapse_dwn={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-dwn_rtl.svg"),width:20,height:20},b.expand_ena={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-ena_rtl.svg"),width:20,height:20},b.expand_ovr=
{src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-ovr_rtl.svg"),width:20,height:20},b.expand_dwn={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-dwn_rtl.svg"),width:20,height:20}):(b.collapse_ena={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-ena.svg"),width:20,height:20},b.collapse_ovr={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-ovr.svg"),width:20,height:20},b.collapse_dwn={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-collapse-button-dwn.svg"),
width:20,height:20},b.expand_ena={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-ena.svg"),width:20,height:20},b.expand_ovr={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-ovr.svg"),width:20,height:20},b.expand_dwn={src:a.ra.Bb("resources/internal-deps/dvt/diagram/container-expand-button-dwn.svg"),width:20,height:20})},LH:function(){var a=this._super();a.data=!0;return a},collapse:function(a,b){var c=this._trigger("beforeCollapse",null,{nodeId:a});
b&&!1===c||(this.bD(),this.Ka.collapse(a))},expand:function(a,b){var c=this._trigger("beforeExpand",null,{nodeId:a});b&&!1===c||(this.bD(),this.Ka.expand(a))},getNodeCount:function(){return this.Ka.getAutomation().getNodeCount()},getNode:function(a){return this.Ka.getAutomation().getNode(a)},getLinkCount:function(){return this.Ka.getAutomation().getLinkCount()},getLink:function(a){return this.Ka.getAutomation().getLink(a)},getPromotedLink:function(a,b){return this.Ka.getAutomation().getPromotedLink(a,
b)},getContextByNode:function(a){return(a=this.getSubIdByNode(a))&&"oj-diagram-tooltip"!==a.subId?a:null}});a.wh=function(){};o_("DiagramUtils",a.wh,a);a.wh.MV=function(b){return function(c){if(b.nodes&&0<c.getNodeCount())for(var d=a.wh.s1(b.nodes),g=b.nodeDefaults&&b.nodeDefaults.labelLayout?b.nodeDefaults.labelLayout:null,l=0;l<c.getNodeCount();l++){var m=c.getNodeByIndex(l),p=d[m.getId()];a.wh.Hpa(m.getChildNodes(),p?p.nodes:null,c,g);a.wh.Ipa(m,p,c,g)}if(b.links&&0<c.getLinkCount())for(d=a.wh.s1(b.links),
l=b.linkDefaults&&b.linkDefaults.path?b.linkDefaults.path:null,g=b.linkDefaults&&b.linkDefaults.labelLayout?b.linkDefaults.labelLayout:null,m=0;m<c.getLinkCount();m++){var p=c.getLinkByIndex(m),t=d[p.getId()];t&&t.path?p.setPoints(t.path):l&&l instanceof Function&&p.setPoints(l(c,p));t&&t.coordinateSpace&&p.setCoordinateSpace(t.coordinateSpace);t&&t.labelLayout?a.wh.yL(p,t.labelLayout):g&&g instanceof Function&&a.wh.yL(p,g(c,p))}b.viewport&&(g=b.viewport,g instanceof Function?c.setViewport(g(c)):
c.setViewport(g))}};o_("DiagramUtils.getLayout",a.wh.MV,a);a.wh.s1=function(a){var b={};if(a)for(var c=0;c<a.length;c++)b[a[c].id]=a[c];return b};a.wh.Hpa=function(b,c,d,g){if(b&&c){c=a.wh.s1(c);for(var l=0;l<b.length;l++){var m=b[l],p=c[m.getId()];a.wh.Hpa(m.getChildNodes(),p?p.nodes:null,d,g);a.wh.Ipa(m,p,d,g)}}};a.wh.Ipa=function(b,c,d,g){b&&c&&(b.setPosition({x:c.x,y:c.y}),c.labelLayout?a.wh.yL(b,c.labelLayout):g&&g instanceof Function?a.wh.yL(b,g(d,b)):g&&a.wh.yL(b,g,b.getPosition()))};a.wh.yL=
function(a,b,c){c=c?c:{x:0,y:0};a.setLabelPosition({x:b.x+c.x,y:b.y+c.y});var d=b.rotationPointX,g=b.rotationPointY;isNaN(d)||isNaN(g)||a.setLabelRotationPoint({x:d+c.x,y:g+c.y});a.setLabelRotationAngle(b.angle);a.setLabelHalign(b.halign);a.setLabelValign(b.valign)};(function(){a.J.Ua("oj-diagram","dvtBaseComponent",{properties:{animationOnDataChange:{type:"string",enumValues:["auto","none"]},animationOnDisplay:{type:"string",enumValues:["auto","none"]},data:{},dnd:{type:"object",properties:{drag:{type:"object",
properties:{nodes:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},drag:{},dragEnd:{},dragStart:{}}},ports:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},linkStyle:{},selector:{type:"string"},drag:{},dragEnd:{},dragStart:{}}}}},drop:{type:"object",properties:{background:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},dragEnter:{},dragLeave:{},dragOver:{},drop:{}}},nodes:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},dragEnter:{},
dragLeave:{},dragOver:{},drop:{}}},links:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},dragEnter:{},dragLeave:{},dragOver:{},drop:{}}},ports:{type:"object",properties:{dataTypes:{type:"Array\x3cstring\x3e"},feedbackStyle:{},selector:{type:"string"},dragEnter:{},dragLeave:{},dragOver:{},drop:{}}}}}}},focusRenderer:{},hiddenCategories:{type:"Array\x3cstring\x3e",writeback:!0},highlightedCategories:{type:"Array\x3cstring\x3e",writeback:!0},highlightMatch:{type:"string",enumValues:["any",
"all"]},hoverBehavior:{type:"string",enumValues:["dim","none"]},hoverRenderer:{},layout:{},linkHighlightMode:{type:"string",enumValues:["linkAndNodes","link"]},linkProperties:{},maxZoom:{type:"number"},minZoom:{type:"number"},nodeHighlightMode:{type:"string",enumValues:["nodeAndIncomingLinks","nodeAndOutgoingLinks","nodeAndLinks","node"]},nodeProperties:{},panDirection:{type:"string",enumValues:["x","y","auto"]},panning:{type:"string",enumValues:["auto","none"]},promotedLinkBehavior:{type:"string",
enumValues:["none","lazy","full"]},renderer:{},selection:{type:"Array\x3cstring\x3e",writeback:!0},selectionMode:{type:"string",enumValues:["none","single","multiple"]},selectionRenderer:{},styleDefaults:{type:"object",properties:{animationDuration:{type:"number"},hoverBehaviorDelay:{type:"number"},linkDefaults:{type:"object",properties:{linkDefaults:{color:{type:"string"},endConnectorType:{type:"string",enumValues:"arrowOpen arrow arrowConcave circle rectangle rectangleRounded none".split(" ")},
labelStyle:{type:"object"},startConnectorType:{type:"string",enumValues:"arrowOpen arrow arrowConcave circle rectangle rectangleRounded none".split(" ")},svgStyle:{type:"object"},width:{type:"number"}}}},nodeDefaults:{type:"object",properties:{nodeDefaults:{icon:{type:"object",properties:{icon:{borderColor:{type:"string"},borderWidth:{type:"number"},color:{type:"string"},height:{type:"number"},pattern:{type:"string",enumValues:"smallChecker smallCrosshatch smallDiagonalLeft smallDiagonalRight smallDiamond smallTriangle largeChecker largeCrosshatch largeDiagonalLeft largeDiagonalRight largeDiamond largeTriangle none".split(" ")},
shape:{type:"string"},source:{type:"string"},sourceHover:{type:"string"},sourceHoverSelected:{type:"string"},sourceSelected:{type:"string"},svgStyle:{type:"object"},width:{type:"number"}}}},labelStyle:{type:"object"},showDisclosure:{type:"string",enumValues:["on","off"]}}}},promotedLink:{type:"object",properties:{promotedLink:{color:{type:"string"},endConnectorType:{type:"string",enumValues:"arrowOpen arrow arrowConcave circle rectangle rectangleRounded none".split(" ")},startConnectorType:{type:"string",
enumValues:"arrowOpen arrow arrowConcave circle rectangle rectangleRounded none".split(" ")},svgStyle:{type:"object"},width:{type:"number"}}}}}},tooltip:{type:"object",properties:{renderer:{}}},touchResponse:{type:"string",enumValues:["touchStart","auto"]},translations:{properties:{componentName:{type:"string"},promotedLink:{type:"string"},promotedLinkAriaDesc:{type:"string"},promotedLinks:{type:"string"}}},zooming:{type:"string",enumValues:["auto","none"]},zoomRenderer:{}},events:{beforeCollapse:{},
beforeExpand:{},collapse:{},expand:{}},methods:{getContextByNode:{},getLink:{},getLinkCount:{},getNode:{},getNodeCount:{},getPromotedLink:{}},extension:{Xa:"ojDiagram"}});var b=a.J.getMetadata("oj-diagram");a.J.register("oj-diagram",{metadata:b,parseFunction:b.extension.VC({"style-defaults.node-defaults.icon.shape":!0})})})()});