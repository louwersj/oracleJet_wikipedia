/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

var ga;function ka(a,F){0==a.indexOf("dvt.")&&(a=a.substring(4));var D=a.split("."),E=eval("dvt");D[0]in E||!E.execScript||E.execScript("var "+D[0]);for(var v;D.length&&(v=D.shift());)D.length||void 0===F?E=E[v]?E[v]:E[v]={}:E[v]=F}Math.floor(2147483648*Math.random()).toString(36);
(function(a){function F(c,h,f,p,v,y,n){F.C.Init.call(this,c.a,"none"==h?null:h,a.j.Rg,f,p,v,y,null,!0,n);this.Ki=c}function D(a){this.Init(a)}function E(a,c){this.Init(a,c)}function v(a,c,f,p,x,y,n,z,w,A){v.C.Init.call(this,a.a,c,f,p,x,null,y,n,z,w,A);this.Ki=a}function x(){this.Init({alta:x.If})}function f(a){this.Init(a.a,a.dispatchEvent,a);this.Ki=a}function c(a){this.Ki=a}a.ui=function(a,c,f){this.Init(a,c,f)};a.f.v(a.ui,a.ec);a.ui.newInstance=function(c,h,f){return new a.ui(c,h,f)};a.ui.prototype.Init=
function(c,h,p){a.ui.C.Init.call(this,c,h,p);this.u=new f(this);this.u.Lf(this);a.m.cb()||this.u.Zr(new D(this.u));this.Ff=new x;this.Pb=[]};a.ui.prototype.xG=function(c,h){if(!c||!h){var f=p.En(this,c,h);this.Lma=f;c||(c=f.items?f.LGa*f.Raa:0);h||(h=f.items?f.JKa*f.Rca:0)}return new a.eg(c,h)};a.ui.prototype.ia=function(c,h,f){this.Ji=this.ha;var t=this.du,v=this.Na?this.Na:0,y=this.ab?this.ab:0;this.u.ed();this.Pb=[];this.du=[];this.Lma=null;this.jk&&(this.ha.removeChild(this.jk),this.jk=null);
this.Vq();this.ne(c);var n=this.a;if(h||f)this.Na=h,this.ab=f;else if(n.Qc.style.display="block",h=this.xG(),a.l.WV(n,h.b,h.i),f=a.l.Nba(n),h.b==f.b&&h.i!=f.i?(this.ab=f.i,h=this.xG(null,this.ab),a.l.WV(n,h.b,this.ab),this.Na=a.l.Nba(n).b):h.b!=f.b&&h.i==f.i?(this.Na=f.b,h=this.xG(this.Na,null),a.l.WV(n,this.Na,h.i),this.ab=a.l.Nba(n).i):(this.Na=f.b,this.ab=f.i),this.Na!=h.b||this.ab!=h.i)this.Lma=null;this.ha=new a.ca(n);this.B(this.ha);p.ia(this,this.ha,new a.U(0,0,this.Na,this.ab),this.Lma);this.Ji?
"none"!=this.J.animationOnDataChange&&c&&(c=new a.Pl(n,null),c.Dn(t,this.du),this.Cb=c.vz()):this.Cb=this.fWa();this.Cb?(a.l.WV(n,Math.max(v,this.Na),Math.max(y,this.ab)),this.u.kn(this),this.jk&&this.ha.removeChild(this.jk),this.Cb.pg(this.R$,this),this.Cb.play()):this.R$()};a.ui.prototype.ne=function(c){c?this.J=this.Ff.mo(c):this.J||(this.J=this.dA());a.m.Hl()||(this.J.animationOnDisplay="none",this.J.animationOnDataChange="none");c=this.J.selectionMode;this.Fd="single"==c?new a.Hb(a.Hb.jv):"multiple"==
c?new a.Hb(a.Hb.os):null;this.u.Fy(this.Fd)};a.ui.prototype.R$=function(){this.Ji&&(this.removeChild(this.Ji),this.Ji.Ec(),this.Ji=null);this.Cb&&(this.u.Lf(this),this.jk&&this.ha.B(this.jk));a.l.WV(this.a,this.Na,this.ab);for(var c,h=0;h<this.Pb.length&&(c=this.Pb[h],"none"==c.yg());h++);this.u.Xr(c);this.Fd&&this.Fd.Vr(this.J.selection,this.Pb);a.sd.Zd(this.J.highlightedCategories,this.Pb,"any"==this.J.highlightMatch);this.ps();this.Bj||this.nl();this.Cb=null;this.Bj=!1};a.ui.prototype.Dva=function(a){this.Pb=
a};a.ui.prototype.gy=function(){return this.Pb};a.ui.prototype.G6a=function(a){this.du.push(a)};a.ui.prototype.F6a=function(a){this.jk=a};a.ui.prototype.o4a=function(){for(var a=0,c=0;c<this.Pb.length;c++)a+=this.Pb[c].XU();return a};a.ui.prototype.Lb=function(){return a.Za.Aq(this.J.animationDuration)/1E3};a.ui.prototype.fWa=function(){var c=this.J.animationOnDisplay,h=this.Lb(),f=this.a,t=new a.U(0,0,this.Na,this.ab);if(a.Ra.isSupported(c))return a.Ra.YD(f,c,this.ha,t,h);var v=[];if("popIn"==c)for(c=
0;c<this.du.length;c++){var y=this.du[c];v.push(new a.qk(f,y,!0,h))}else if("none"!=c){for(c=0;c<this.du.length;c++){var y=this.du[c],n=new a.td(f,y,h),z,w;p.Ea(this)?(z=p.mua(this)?this.Na:0,w=y.Kg(),y.Zp(z),n.da.aa(a.L.ta,y,y.Kg,y.Zp,w)):(z=p.lua(this)?this.ab:0,w=y.Lg(),y.$p(z),n.da.aa(a.L.ta,y,y.Lg,y.$p,w));v.push(n)}v.push(a.Ra.YD(f,a.Ra.Vz,this.ha,t,h))}return 0<v.length?new a.$d(f,v):null};a.ui.prototype.Zd=function(c){var h=this.A();h.highlightedCategories=a.bb.clone(c);a.sd.Zd(c,this.gy(),
"any"==h.highlightMatch)};a.ui.prototype.select=function(c){this.A().selection=a.bb.clone(c);this.Fd&&this.Fd.Vr(c,this.gy())};a.ui.prototype.vk=function(){return a.I.Zc(this.A(),"componentName",a.I.pa,"PICTOCHART")};a.ui.prototype.Bi=function(){this.sBa||(this.sBa=new c(this));return this.sBa};a.f.v(c,a.Lc);c.prototype.Ql=function(a){return(a=this.Ki.Ob().Ya(a))&&a instanceof E?"item["+this.Ki.gy().indexOf(a)+"]":null};c.prototype.Sh=function(c){if(c==a.Lc.Dw)return this.eA(this.Ki);var h=c.indexOf("[");
return 0<h&&"item"===c.substring(0,h)&&(c=this.Ki.gy()[parseInt(c.substring(h+1,c.length-1))])?c.ja():null};c.prototype.getItem=function(a){if(a=this.Ki.gy()[a]){var c={};c.color=a.pi();c.tooltip=a.bf();c.id=a.getId();c.name=a.getName();c.count=a.XU();c.selected=a.gb();return c}return null};c.prototype.m4=function(){return this.Ki.gy().length};a.f.v(f,a.u);f.prototype.Ij=function(c,h,f){c=this.Ki.A();"none"!=c.hoverBehavior&&(h=h.rd?h.rd():[],c.highlightedCategories=f?h.slice():null,f=a.la.MI(c.highlightedCategories,
f),h=a.Za.Aq(c.hoverBehaviorDelay),this.pF.Ef(f,this.Ki.gy(),h,"any"==c.highlightMatch))};f.prototype.iF=function(a){if(a=this.Ya(a.target))this.Mz(a),a.fb&&a.fb()||this.Ay(a)};f.prototype.DJ=function(a){(a=this.Ya(a.target))&&a.fb&&a.fb()&&this.Ay(a)};f.prototype.xM=function(a){if(a=this.Ya(a.target))this.Mz(a),a.fb&&a.fb()||this.Ay(a)};f.prototype.ev=function(a){if(a=this.Ya(a.target))this.Mz(a),a.fb&&a.fb()||this.Ay(a)};f.prototype.wM=function(a){var c=this.Ya(a.target);c&&c.fb&&c.fb()&&(a.preventDefault(),
a.stopPropagation(),this.Ay(c))};f.prototype.Ay=function(c){c instanceof E&&c.bk()&&this.kt(a.la.zV(c.getId()))};f.prototype.Mz=function(c){c&&c.ph&&c.ph()&&this.kt(a.la.yy("action",c.ph(),c.getId()))};a.f.v(x,a.ka);x.If={animationOnDisplay:"none",animationOnDataChange:"none",animationDuration:750,drilling:"off",hiddenCategories:[],highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",hoverBehaviorDelay:200,layout:"horizontal",layoutOrigin:"topStart",selection:[],selectionMode:"none",
_defaultColor:"#a6acb1",_noneShapeColor:"rgba(255,255,255,0)",_defaultSize:32,_defaultShape:"rectangle",_gapRatio:.25,_textStyle:new a.j(a.ka.LW+"color: #252525;"),_statusMessageStyle:new a.j(a.ka.LW+"color: #252525;"),_tooltipStyle:new a.j("border-collapse: separate; border-spacing: 1px"),_tooltipLabelStyle:new a.j("color: #666666; padding: 0px 2px"),_tooltipValueStyle:new a.j("color: #333333; padding: 0px 2px")};a.f.v(v,a.xc);v.prototype.Mf=function(c,h){var f=new a.td(this.a,this,.75*this.Ki.Lb()),
p=f.da,v=this.Ek();this.hm(h.Ek());p.aa(a.L.Hf,this,this.Ek,this.hm,v);h.qa(0);c.add(f,1)};v.prototype.ai=function(c){c.add(new a.Wg(this.a,this,.5*this.Ki.Lb()),0)};v.prototype.nh=function(c){this.qa(0);c.add(new a.dg(this.a,this,.5*this.Ki.Lb()),2)};v.prototype.Ek=function(){return[this.Kg(),this.Lg(),this.getWidth(),this.getHeight()]};v.prototype.hm=function(a){this.Zp(a[0]);this.$p(a[1]);this.jb(a[2]);this.Mb(a[3])};a.f.v(E,a.ca);E.ys=0;E.prototype.Init=function(c,h){E.C.Init.call(this,c.a,null,
h.id);this.Ki=c;this.yl=h;this.lc=null!=h.id?h.id:null!=h.name?h.name:"_defaultId"+E.ys;E.ys++;this.XO="none"==h.shape;this.Tc=this.wi=!1;this.lEa=new a.P(0,0);(this.fb()||this.bk())&&this.setCursor("pointer");c.Ob().Xb(this,this)};E.prototype.KHa=function(){var a=this.yl.columnSpan;return null!=a&&0<=a?Math.round(a):1};E.prototype.ZIa=function(){var a=this.yl.rowSpan;return null!=a&&0<=a?Math.round(a):1};E.prototype.XU=function(){var a=this.yl.count;return null!=a?Math.max(a,0):1};E.prototype.yg=
function(){return this.yl.shape||this.Ki.A()._defaultShape};E.prototype.Zb=function(){return this.XO?this.Ki.A()._noneShapeColor:this.yl.color||this.Ki.A()._defaultColor};E.prototype.oo=function(){return this.yl.borderColor};E.prototype.Rh=function(){return this.yl.borderWidth};E.prototype.Ir=function(){return this.yl.className||this.yl.svgClassName};E.prototype.N=function(){return this.yl.style||this.yl.svgStyle};E.prototype.fJa=function(){return this.yl.source};E.prototype.d4a=function(){return this.yl.sourceSelected};
E.prototype.b4a=function(){return this.yl.sourceHover};E.prototype.c4a=function(){return this.yl.sourceHoverSelected};E.prototype.getName=function(){return this.yl.name};E.prototype.getId=function(){return this.lc};E.prototype.ph=function(){return this.yl.action};E.prototype.Eh=function(){return this.yl.shortDesc};E.prototype.bk=function(){if(this.XO)return!1;var a=this.yl.drilling;return a&&"inherit"!=a?"on"==a:"on"==this.Ki.A().drilling};E.prototype.Wp=function(){return this.fb()&&this.bk()&&!this.XO};
E.prototype.b9a=function(){this.zg("img");this.Ro()};E.prototype.bf=function(){if(this.XO)return"";var c=this.Ki.A(),h=this.Ki.A().tooltip;if(h=h?h.renderer:null){var c=this.Ki.a.cf(),f={id:this.getId(),name:this.getName(),count:this.XU(),color:this.Zb()};return c.Rs(h,f)}if(null!=this.Eh())return this.Eh();h="";(f=this.getName())&&(h=a.Rb.BQ("td",c._tooltipLabelStyle)+f+"\x3c/td\x3e");f=a.m.ea(this.Ki.a);c._tooltipLabelStyle.Ma(a.j.ZM,f?"left":"right");c._tooltipValueStyle.Ma(a.j.ZM,f?"right":"left");
return a.Rb.BQ("table",c._tooltipStyle)+"\x3ctr\x3e"+h+a.Rb.BQ("td",c._tooltipValueStyle)+this.Cla()+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"};E.prototype.pi=function(){return this.Zb()};E.prototype.Cla=function(){return a.I.Zc(this.Ki.A(),"labelCountWithTotal",a.I.pa,"COUNT_WITH_TOTAL",[this.XU(),this.Ki.o4a()])};E.prototype.fb=function(){return"none"!=this.Ki.A().selectionMode&&!this.XO};E.prototype.gb=function(){return this.wi};E.prototype.hc=function(a){this.wi=a;this.Ro();for(var c=0;c<this.Vc();c++){var f=
this.dc(c);(f instanceof F||f instanceof v)&&f.hc(a)}};E.prototype.Rc=function(){for(var a=0;a<this.Vc();a++){var c=this.dc(a);(c instanceof F||c instanceof v)&&c.Rc()}};E.prototype.Cc=function(){for(var a=0;a<this.Vc();a++){var c=this.dc(a);(c instanceof F||c instanceof v)&&c.Cc()}};E.prototype.Xd=function(){return[this]};E.prototype.te=function(){var c=[],h=this.Ki.A();this.fb()&&c.push(a.I.Zc(h,this.gb()?"stateSelected":"stateUnselected",a.I.pa,this.gb()?"STATE_SELECTED":"STATE_UNSELECTED"));this.bk()&&
c.push(a.I.Zc(h,"stateDrillable",a.I.pa,"STATE_DRILLABLE"));h=this.getName();h=null!=this.Eh()?this.Eh():null==h?this.Cla():a.I.Ja(a.I.pa,"COLON_SEP_LIST",[h,this.Cla()]);return a.R.lm(h,c)};E.prototype.Ro=function(){a.m.Vj()||this.Od("label",this.te())};E.prototype.rd=function(){return this.yl.categories||[this.getId()]};E.prototype.Kd=function(c){var h=this.Ki.Ob().ya;return c.type==a.MouseEvent.He||h.xo(c)?this:h.Uh(c)?D.Kd(this.Ki,this,c):null};E.prototype.md=function(a){return this.V(a)};E.prototype.$j=
function(){return this.ja()};E.prototype.rh=function(){this.XO||(this.Tc=!0,this.Rc())};E.prototype.mf=function(){this.XO||(this.Tc=!1,this.Cc())};E.prototype.Ae=function(){return this.Tc};E.prototype.$7a=function(a){this.lEa=a};E.prototype.cV=function(){return this.lEa};a.f.v(D,a.ya);D.prototype.Iz=function(a){return this.Uh(a)&&!a.ctrlKey};D.prototype.xo=function(c){return c.keyCode==a.KeyboardEvent.Kj&&c.ctrlKey};D.Kd=function(c,h,f,t){var v=c.gy();t||(t=h);if("none"==h.yg()&&h!=t){var y=a.Y.$b(v,
h);if(0==y||y==v.length-1)return t}var n=p.mua(c),z=p.lua(c),w=p.Ea(c),y=h,n=f.keyCode==a.KeyboardEvent.Ne&&n||f.keyCode==a.KeyboardEvent.Be&&!n||f.keyCode==a.KeyboardEvent.sg&&z||f.keyCode==a.KeyboardEvent.kf&&!z,w=f.keyCode==a.KeyboardEvent.Ne&&w||f.keyCode==a.KeyboardEvent.Be&&w||f.keyCode==a.KeyboardEvent.sg&&!w||f.keyCode==a.KeyboardEvent.kf&&!w,n=a.Y.$b(v,h)+(n?1:-1);w?y=a.ya.Kd(h,f,v):n<v.length&&0<=n&&(y=v[n]);"none"==y.yg()&&(y=y!=h?D.Kd(c,y,f,t):t);return y};D.prototype.Rk=function(c){var h=
this.Fc.Fe();return h&&c.keyCode==a.KeyboardEvent.Mn?(this.Fc.Ay(h),a.u.Ud(c),h):D.C.Rk.call(this,c)};a.f.v(F,a.W);F.prototype.Mf=function(c,h){var f=new a.td(this.a,this,.75*this.Ki.Lb()),p=f.da,v=this.Hd(),y=h.Hd().clone();y.mc(v)||(this.Ia(y),p.aa(a.L.At,this,this.Hd,this.Ia,v));v=this.Ek();this.hm(h.Ek());p.aa(a.L.Hf,this,this.Ek,this.hm,v);h.qa(0);c.add(f,1)};F.prototype.ai=function(c){c.add(new a.Wg(this.a,this,.5*this.Ki.Lb()),0)};F.prototype.nh=function(c){this.qa(0);c.add(new a.dg(this.a,
this,.5*this.Ki.Lb()),2)};F.prototype.Ek=function(){return[this.Kg(),this.Lg(),this.getWidth(),this.getHeight()]};F.prototype.hm=function(a){this.Zp(a[0]);this.$p(a[1]);this.jb(a[2]);this.Mb(a[3])};var p={};a.f.v(p,a.f);p.ia=function(c,h,f,t){var x=c.a,y=new a.Rect(x,f.x,f.y,f.b,f.i);y.Yb();h.B(y);t||(t=p.En(c,f.b,f.i));if(t.items){c.Dva(t.items);for(var y=c.A()._gapRatio*t.U5a,n=p.Ea(c),z=p.lua(c),w=p.mua(c),A=new a.fv,d=0,g=0,B=0,r=0;r<t.items.length;r++){var l=t.items[r],C=l.KHa(),K=l.ZIa();if(!(0>=
C||0>=K)){for(var D=C*t.Raa,E=K*t.Rca,ca=l.XU(),ja=0,ea=!0,ha;0<ca;){if(C!=d||K!=g)B=0;0==B&&(ha=p.FCa(A,C,K,t.LGa,t.JKa,n));if(null==ha)break;var da=ha.Xqa*t.Raa+D/2,X=ha.bwa*t.Rca+E/2,da=f.x+(w?f.b-da:da),X=f.y+(z?f.i-X:X),aa=Math.min(1-B,ca),Y,P,S,T;n?(Y=da-D/2,P=z?X+E*(.5-aa-B):X+E*(B-.5),S=D,T=E*aa):(Y=w?da+D*(.5-aa-B):da+D*(B-.5),P=X-E/2,S=D*aa,T=E);var J;1==aa?(J=l.getId()+"_"+ja,ja++):J=Math.random();if(l.fJa())J=new v(c,da,X,D,E,l.fJa(),l.d4a(),l.b4a(),l.c4a(),J+"_I");else{var W=new a.Rect(x,
Y,P,S,T);W.Yb();l.B(W);J=new F(c,l.yg(),da,X,D-t.Raa*y,E-t.Rca*y,J+"_S");J.$a(l.Zb());J.uc(l.oo(),null,l.Rh());J.eS(l.Zb());J.sc(l.Ir());J.Ma(l.N())}1>aa&&(W=new a.fc,W.se(Y,P,S,T),J.be(W));ea&&(l.$7a(new a.P(da,X)),ea=!1);l.B(J);c.G6a(J);ca-=aa;B=(B+aa)%1}h.B(l);l.b9a();d=C;g=K}}}else p.tm(c,h,f)};p.En=function(c,h,f){var t=c.A(),v=t.items;if(!v)return{};for(var y=a.Y.VB(t.hiddenCategories),n=[],z=0,w=1,A=1,d=Infinity,g=0;g<v.length;g++)if(null!=v[g]){var B=new E(c,v[g]);if(!y||!a.Y.BI(y,B.rd())){var r=
B.KHa(),l=B.ZIa();0>=r||0>=l||(r>w&&(w=r),l>A&&(A=l),r<d&&(d=r),l<d&&(d=l),z+=r*l*B.XU(),n.push(B))}}if(0==z)return{};v=t.columnWidth;y=t.rowHeight;h&&f||(v||(v=y?y:t._defaultSize),y||(y=v));c=p.Ea(c);g=t.columnCount;t=t.rowCount;g||t||(h&&f?c?t=p.HT(Math.sqrt(z*f/h),A):g=p.HT(Math.sqrt(z*h/f),w):h?g=Math.max(Math.floor(h/v),1):f?t=Math.max(Math.floor(f/y),1):c?t=p.HT(Math.sqrt(z),A):g=p.HT(Math.sqrt(z),w));g?t||(t=p.HT(z/g,A)):g=p.HT(z/t,w);h&&f&&(v||(v=y?y:Math.min(h/g,f/t)),y||(y=v));return 0>=
g||0>=t||0>=v||0>=y?{}:{items:n,LGa:g,JKa:t,Raa:v,Rca:y,U5a:d}};p.HT=function(a,c){return Math.ceil(a/c)*c};p.FCa=function(a,c,f,t,v,y){if(y)return(a=p.FCa(a,f,c,v,t,!1))?{Xqa:a.bwa,bwa:a.Xqa}:null;for(y=0;y<v-f+1;y++)for(var n=0;n<t-c+1;n++)if(p.bUa(a,n,y,c,f))return p.XXa(a,n,y,c,f),{Xqa:n,bwa:y};return null};p.bUa=function(a,c,f,p,v){for(var y=0;y<v;y++)for(var n=0;n<p;n++)if(a.get(c+n,f+y))return!1;return!0};p.XXa=function(a,c,f,p,v){for(var y=0;y<v;y++)for(var n=0;n<p;n++)a.put(c+n,f+y,!0)};
p.tm=function(c,h,f){var p=c.A(),v=a.I.Zc(p,"labelNoData",a.I.pa,"NO_DATA");h=a.ga.tm(h,v,f.clone(),c.Ob(),p._statusMessageStyle);c.F6a(h)};p.Ea=function(a){return"vertical"==a.A().layout};p.lua=function(a){a=a.A().layoutOrigin;return"bottomStart"==a||"bottomEnd"==a};p.mua=function(c){var h=c.A().layoutOrigin,h="topEnd"==h||"bottomEnd"==h;return a.m.ea(c.a)?!h:h};a.K(a,"PictoChart",a.ui);a.K(a.ui,"newInstance",a.ui.newInstance);a.K(a.ui.prototype,"destroy",a.ui.prototype.Ec);a.K(a.ui.prototype,"getAutomation",
a.ui.prototype.Bi);a.K(a.ui.prototype,"highlight",a.ui.prototype.Zd);a.K(a.ui.prototype,"render",a.ui.prototype.ia);a.K(a.ui.prototype,"select",a.ui.prototype.select);a.K(c.prototype,"getDomElementForSubId",c.prototype.Sh);a.K(c.prototype,"getItem",c.prototype.getItem);a.K(c.prototype,"getItemCount",c.prototype.m4)})(dvt);
  return dvt;
});
